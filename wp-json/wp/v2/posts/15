{"id":15,"date":"2007-05-02T17:55:00","date_gmt":"2007-05-02T17:55:00","guid":{"rendered":"\/2007\/09\/18\/riff-activerecord-diff-plugin"},"modified":"2007-05-02T17:55:00","modified_gmt":"2007-05-02T17:55:00","slug":"riff-activerecord-diff-plugin","status":"publish","type":"post","link":"http:\/\/pullmonkey.com\/2007\/05\/02\/riff-activerecord-diff-plugin\/","title":{"rendered":"Riff &#8211; ActiveRecord diff plugin"},"content":{"rendered":"<p>The other day I went looking for a quick way to get a diff between revisions of a record for ActiveRecord.<br \/>\nThis led to the <a href=\"http:\/\/tfletcher.com\/svn\/rails-plugins\/riff\/README\">Riff plugin<\/a> for Ruby on Rails.<br \/>\nThere are two uses of this plugin:<\/p>\n<ol>\n<li>object1.diff?(object2)  #=> true | false<\/li>\n<li>object2.diff(object2)    #=> hash of differences<\/li>\n<\/ol>\n<p>Here is an example:<\/p>\n<table class=\"CodeRay\">\n<tr>\n<td class=\"line_numbers\" title=\"click to toggle\" onclick=\"with (this.firstChild.style) { display = (display == '') ? 'none' : '' }\">\n<pre>1<tt>\n<\/tt>2<tt>\n<\/tt>3<tt>\n<\/tt>4<tt>\n<\/tt><strong>5<\/strong><tt>\n<\/tt>6<tt>\n<\/tt>7<tt>\n<\/tt>8<tt>\n<\/tt>9<tt>\n<\/tt><strong>10<\/strong><tt>\n<\/tt>11<tt>\n<\/tt>12<tt>\n<\/tt>13<tt>\n<\/tt>14<tt>\n<\/tt><strong>15<\/strong><tt>\n<\/tt>16<tt>\n<\/tt>17<tt>\n<\/tt>18<tt>\n<\/tt>19<tt>\n<\/tt><strong>20<\/strong><tt>\n<\/tt><\/pre>\n<\/td>\n<td class=\"code\">\n<pre ondblclick=\"with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }\"><tt>\n<\/tt>    &gt;&gt; requests = <span class=\"co\">Request<\/span>.find(<span class=\"sy\">:all<\/span>)<tt>\n<\/tt>    &gt;&gt; request1 = requests[<span class=\"i\">0<\/span>]<tt>\n<\/tt>    =&gt; <span class=\"c\">#&lt;Request:0x2a9c93f360 @attributes={.....}&gt;<\/span><tt>\n<\/tt>    &gt;&gt; request2 = requests[<span class=\"i\">1<\/span>]<tt>\n<\/tt>    =&gt; <span class=\"c\">#&lt;Request:0x2a9c93f310 @attributes={.....}&gt;  <\/span><tt>\n<\/tt>    &gt;&gt; request1.diff?(request2)<tt>\n<\/tt>    =&gt; <span class=\"pc\">true<\/span><tt>\n<\/tt>    &gt;&gt; request1.diff(request2)<tt>\n<\/tt>    =&gt; {<span class=\"sy\">:last_email_alert_at<\/span>=&gt;[<span class=\"co\">Wed<\/span> <span class=\"co\">Apr<\/span> <span class=\"i\">11<\/span> <span class=\"i\">15<\/span>:<span class=\"i\">36<\/span>:<span class=\"i\">03<\/span> <span class=\"co\">MDT<\/span> <span class=\"i\">2007<\/span>, <span class=\"pc\">nil<\/span>], <tt>\n<\/tt>           <span class=\"sy\">:description<\/span>=&gt;[<span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">hello<\/span><span class=\"dl\">&quot;<\/span><\/span>, <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">goodbye<\/span><span class=\"dl\">&quot;<\/span><\/span>],<tt>\n<\/tt>           <span class=\"sy\">:due_date<\/span>=&gt;[<span class=\"c\">#&lt;Date: 4908383\/2,0,2299161&gt;, <\/span><tt>\n<\/tt>                       <span class=\"c\">#&lt;Date: 4908421\/2,0,2299161&gt;], <\/span><tt>\n<\/tt>           <span class=\"sy\">:summary<\/span>=&gt;[<span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Do this for me.....<\/span><span class=\"dl\">&quot;<\/span><\/span>, <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Test<\/span><span class=\"dl\">&quot;<\/span><\/span>], <tt>\n<\/tt>           <span class=\"sy\">:created_at<\/span>=&gt;[<span class=\"co\">Mon<\/span> <span class=\"co\">Apr<\/span> <span class=\"i\">09<\/span> <span class=\"i\">10<\/span>:<span class=\"i\">58<\/span>:<span class=\"i\">24<\/span> <span class=\"co\">MDT<\/span> <span class=\"i\">2007<\/span>, <tt>\n<\/tt>                         <span class=\"co\">Mon<\/span> <span class=\"co\">Apr<\/span> <span class=\"i\">09<\/span> <span class=\"i\">11<\/span>:<span class=\"i\">08<\/span>:<span class=\"i\">17<\/span> <span class=\"co\">MDT<\/span> <span class=\"i\">2007<\/span>], <tt>\n<\/tt>           <span class=\"sy\">:last_email_alert_by<\/span>=&gt;[<span class=\"i\">2<\/span>, <span class=\"pc\">nil<\/span>], <tt>\n<\/tt>           <span class=\"sy\">:version<\/span>=&gt;[<span class=\"i\">30<\/span>, <span class=\"i\">1<\/span>], <tt>\n<\/tt>           <span class=\"sy\">:updated_at<\/span>=&gt;[<span class=\"co\">Wed<\/span> <span class=\"co\">Apr<\/span> <span class=\"i\">11<\/span> <span class=\"i\">15<\/span>:<span class=\"i\">36<\/span>:<span class=\"i\">03<\/span> <span class=\"co\">MDT<\/span> <span class=\"i\">2007<\/span>, <tt>\n<\/tt>                         <span class=\"co\">Mon<\/span> <span class=\"co\">Apr<\/span> <span class=\"i\">09<\/span> <span class=\"i\">11<\/span>:<span class=\"i\">08<\/span>:<span class=\"i\">17<\/span> <span class=\"co\">MDT<\/span> <span class=\"i\">2007<\/span>]}<tt>\n<\/tt><\/pre>\n<\/td>\n<\/tr>\n<\/table>\n<p>Yah, so that is cool, but with a little more time on my hands I decided to figure out what is going on behind the scenes. <br \/>\nHere is how you would normally get a diff between hashes, unfortunately you will see later this does not work so well:<br \/>\nFirst, create the hashes:<\/p>\n<table class=\"CodeRay\">\n<tr>\n<td class=\"line_numbers\" title=\"click to toggle\" onclick=\"with (this.firstChild.style) { display = (display == '') ? 'none' : '' }\">\n<pre>1<tt>\n<\/tt>2<tt>\n<\/tt>3<tt>\n<\/tt>4<tt>\n<\/tt><\/pre>\n<\/td>\n<td class=\"code\">\n<pre ondblclick=\"with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }\">  &gt;&gt; r1 = requests[<span class=\"i\">0<\/span>].attributes<tt>\n<\/tt>  =&gt; {...}<tt>\n<\/tt>  &gt;&gt; r2 = requests[<span class=\"i\">1<\/span>].attributes<tt>\n<\/tt>  =&gt; {...}<tt>\n<\/tt><\/pre>\n<\/td>\n<\/tr>\n<\/table>\n<p>Next, show that the records contain the same keys:<\/p>\n<table class=\"CodeRay\">\n<tr>\n<td class=\"line_numbers\" title=\"click to toggle\" onclick=\"with (this.firstChild.style) { display = (display == '') ? 'none' : '' }\">\n<pre>1<tt>\n<\/tt>2<tt>\n<\/tt><\/pre>\n<\/td>\n<td class=\"code\">\n<pre ondblclick=\"with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }\">  &gt;&gt; r1.keys - r2.keys<tt>\n<\/tt>  =&gt; [] <tt>\n<\/tt><\/pre>\n<\/td>\n<\/tr>\n<\/table>\n<p>Let's get the diffs, one for first - second and one for second - first:<\/p>\n<table class=\"CodeRay\">\n<tr>\n<td class=\"line_numbers\" title=\"click to toggle\" onclick=\"with (this.firstChild.style) { display = (display == '') ? 'none' : '' }\">\n<pre>1<tt>\n<\/tt>2<tt>\n<\/tt>3<tt>\n<\/tt>4<tt>\n<\/tt><strong>5<\/strong><tt>\n<\/tt>6<tt>\n<\/tt>7<tt>\n<\/tt><\/pre>\n<\/td>\n<td class=\"code\">\n<pre ondblclick=\"with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }\">  &gt;&gt; diff_2_1 = r2.values - r1.values<tt>\n<\/tt>  =&gt; [<span class=\"co\">Mon<\/span> <span class=\"co\">Apr<\/span> <span class=\"i\">09<\/span> <span class=\"i\">11<\/span>:<span class=\"i\">08<\/span>:<span class=\"i\">17<\/span> <span class=\"co\">MDT<\/span> <span class=\"i\">2007<\/span>, <span class=\"i\">4<\/span>, <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Test<\/span><span class=\"dl\">&quot;<\/span><\/span>, <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">goodbye<\/span><span class=\"dl\">&quot;<\/span><\/span>, <tt>\n<\/tt>    <span class=\"c\">#&lt;Date: 4908421\/2,0,2299161&gt;, Mon Apr 09 11:08:17 MDT 2007]<\/span><tt>\n<\/tt>  &gt;&gt; diff_1_2 = r1.values - r2.values<tt>\n<\/tt>  =&gt; [<span class=\"co\">Wed<\/span> <span class=\"co\">Apr<\/span> <span class=\"i\">11<\/span> <span class=\"i\">15<\/span>:<span class=\"i\">36<\/span>:<span class=\"i\">03<\/span> <span class=\"co\">MDT<\/span> <span class=\"i\">2007<\/span>, <span class=\"co\">Wed<\/span> <span class=\"co\">Apr<\/span> <span class=\"i\">11<\/span> <span class=\"i\">15<\/span>:<span class=\"i\">36<\/span>:<span class=\"i\">03<\/span> <span class=\"co\">MDT<\/span> <span class=\"i\">2007<\/span>, <tt>\n<\/tt>    <span class=\"i\">3<\/span>, <span class=\"i\">30<\/span>, <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Do this for me.....<\/span><span class=\"dl\">&quot;<\/span><\/span>, <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Hello<\/span><span class=\"dl\">&quot;<\/span><\/span>, <span class=\"c\">#&lt;Date: 4908383\/2,0,2299161&gt;, <\/span><tt>\n<\/tt>    <span class=\"co\">Mon<\/span> <span class=\"co\">Apr<\/span> <span class=\"i\">09<\/span> <span class=\"i\">10<\/span>:<span class=\"i\">58<\/span>:<span class=\"i\">24<\/span> <span class=\"co\">MDT<\/span> <span class=\"i\">2007<\/span>]<tt>\n<\/tt><\/pre>\n<\/td>\n<\/tr>\n<\/table>\n<p>This would be perfect if the results of the hash diffs were the same size:<\/p>\n<table class=\"CodeRay\">\n<tr>\n<td class=\"line_numbers\" title=\"click to toggle\" onclick=\"with (this.firstChild.style) { display = (display == '') ? 'none' : '' }\">\n<pre>1<tt>\n<\/tt>2<tt>\n<\/tt>3<tt>\n<\/tt>4<tt>\n<\/tt><\/pre>\n<\/td>\n<td class=\"code\">\n<pre ondblclick=\"with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }\">  &gt;&gt; diff_1_2.size<tt>\n<\/tt>  =&gt; <span class=\"i\">8<\/span><tt>\n<\/tt>  &gt;&gt; diff_2_1.size<tt>\n<\/tt>  =&gt; <span class=\"i\">6<\/span><tt>\n<\/tt><\/pre>\n<\/td>\n<\/tr>\n<\/table>\n<p>Well this means we can't assume the indexes match.  So here is how we really need to get the hash differences:<\/p>\n<table class=\"CodeRay\">\n<tr>\n<td class=\"line_numbers\" title=\"click to toggle\" onclick=\"with (this.firstChild.style) { display = (display == '') ? 'none' : '' }\">\n<pre>1<tt>\n<\/tt>2<tt>\n<\/tt>3<tt>\n<\/tt>4<tt>\n<\/tt><strong>5<\/strong><tt>\n<\/tt>6<tt>\n<\/tt>7<tt>\n<\/tt>8<tt>\n<\/tt>9<tt>\n<\/tt><strong>10<\/strong><tt>\n<\/tt>11<tt>\n<\/tt>12<tt>\n<\/tt>13<tt>\n<\/tt>14<tt>\n<\/tt><strong>15<\/strong><tt>\n<\/tt>16<tt>\n<\/tt>17<tt>\n<\/tt>18<tt>\n<\/tt>19<tt>\n<\/tt><strong>20<\/strong><tt>\n<\/tt><\/pre>\n<\/td>\n<td class=\"code\">\n<pre ondblclick=\"with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }\">  &gt;&gt; ra1 = r1.to_a  <span class=\"c\">#=&gt; converted to an array [[key,value],[key2,value2]...]<\/span><tt>\n<\/tt>  &gt;&gt; ra2 = r2.to_a  <span class=\"c\">#=&gt; converted to an array <\/span><tt>\n<\/tt>  &gt;&gt; diff_a_1_2 = ra1 - ra2 <tt>\n<\/tt>  =&gt; [[<span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">updated_at<\/span><span class=\"dl\">&quot;<\/span><\/span>, <span class=\"co\">Wed<\/span> <span class=\"co\">Apr<\/span> <span class=\"i\">11<\/span> <span class=\"i\">15<\/span>:<span class=\"i\">36<\/span>:<span class=\"i\">03<\/span> <span class=\"co\">MDT<\/span> <span class=\"i\">2007<\/span>], <tt>\n<\/tt>    [<span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">last_email_alert_at<\/span><span class=\"dl\">&quot;<\/span><\/span>, <span class=\"co\">Wed<\/span> <span class=\"co\">Apr<\/span> <span class=\"i\">11<\/span> <span class=\"i\">15<\/span>:<span class=\"i\">36<\/span>:<span class=\"i\">03<\/span> <span class=\"co\">MDT<\/span> <span class=\"i\">2007<\/span>], [<span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">id<\/span><span class=\"dl\">&quot;<\/span><\/span>, <span class=\"i\">3<\/span>], <tt>\n<\/tt>    [<span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">version<\/span><span class=\"dl\">&quot;<\/span><\/span>, <span class=\"i\">30<\/span>], [<span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">summary<\/span><span class=\"dl\">&quot;<\/span><\/span>, <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Do this for me.....<\/span><span class=\"dl\">&quot;<\/span><\/span>], <tt>\n<\/tt>    [<span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">last_email_alert_by<\/span><span class=\"dl\">&quot;<\/span><\/span>, <span class=\"i\">2<\/span>], [<span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">description<\/span><span class=\"dl\">&quot;<\/span><\/span>, <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Hello<\/span><span class=\"dl\">&quot;<\/span><\/span>], <tt>\n<\/tt>    [<span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">due_date<\/span><span class=\"dl\">&quot;<\/span><\/span>, <span class=\"c\">#&lt;Date: 4908383\/2,0,2299161&gt;], <\/span><tt>\n<\/tt>    [<span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">created_at<\/span><span class=\"dl\">&quot;<\/span><\/span>, <span class=\"co\">Mon<\/span> <span class=\"co\">Apr<\/span> <span class=\"i\">09<\/span> <span class=\"i\">10<\/span>:<span class=\"i\">58<\/span>:<span class=\"i\">24<\/span> <span class=\"co\">MDT<\/span> <span class=\"i\">2007<\/span>]]<tt>\n<\/tt>  &gt;&gt; diff_a_2_1 = ra2 - ra1<tt>\n<\/tt>  =&gt; [[<span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">updated_at<\/span><span class=\"dl\">&quot;<\/span><\/span>, <span class=\"co\">Mon<\/span> <span class=\"co\">Apr<\/span> <span class=\"i\">09<\/span> <span class=\"i\">11<\/span>:<span class=\"i\">08<\/span>:<span class=\"i\">17<\/span> <span class=\"co\">MDT<\/span> <span class=\"i\">2007<\/span>], <tt>\n<\/tt>    [<span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">last_email_alert_at<\/span><span class=\"dl\">&quot;<\/span><\/span>, <span class=\"pc\">nil<\/span>], [<span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">id<\/span><span class=\"dl\">&quot;<\/span><\/span>, <span class=\"i\">4<\/span>], [<span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">version<\/span><span class=\"dl\">&quot;<\/span><\/span>, <span class=\"i\">1<\/span>], <tt>\n<\/tt>    [<span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">summary<\/span><span class=\"dl\">&quot;<\/span><\/span>, <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Test<\/span><span class=\"dl\">&quot;<\/span><\/span>], [<span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">last_email_alert_by<\/span><span class=\"dl\">&quot;<\/span><\/span>, <span class=\"pc\">nil<\/span>], <tt>\n<\/tt>    [<span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">description<\/span><span class=\"dl\">&quot;<\/span><\/span>, <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">goodbye<\/span><span class=\"dl\">&quot;<\/span><\/span>], <tt>\n<\/tt>    [<span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">due_date<\/span><span class=\"dl\">&quot;<\/span><\/span>, <span class=\"c\">#&lt;Date: 4908421\/2,0,2299161&gt;], <\/span><tt>\n<\/tt>    [<span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">created_at<\/span><span class=\"dl\">&quot;<\/span><\/span>, <span class=\"co\">Mon<\/span> <span class=\"co\">Apr<\/span> <span class=\"i\">09<\/span> <span class=\"i\">11<\/span>:<span class=\"i\">08<\/span>:<span class=\"i\">17<\/span> <span class=\"co\">MDT<\/span> <span class=\"i\">2007<\/span>]]<tt>\n<\/tt>  &gt;&gt; diff_a_2_1.size<tt>\n<\/tt>  =&gt; <span class=\"i\">9<\/span><tt>\n<\/tt>  &gt;&gt; diff_a_1_2.size<tt>\n<\/tt>  =&gt; <span class=\"i\">9<\/span><tt>\n<\/tt><\/pre>\n<\/td>\n<\/tr>\n<\/table>\n<p>Well, that's odd there appear to be nine differences, where as before we saw a max of eight differences.  This difference in size can be explained by the missing nils in the prior example.<br \/>\nNow we create the diff hash, to have results like riff:<\/p>\n<table class=\"CodeRay\">\n<tr>\n<td class=\"line_numbers\" title=\"click to toggle\" onclick=\"with (this.firstChild.style) { display = (display == '') ? 'none' : '' }\">\n<pre>1<tt>\n<\/tt>2<tt>\n<\/tt>3<tt>\n<\/tt>4<tt>\n<\/tt><strong>5<\/strong><tt>\n<\/tt>6<tt>\n<\/tt>7<tt>\n<\/tt>8<tt>\n<\/tt>9<tt>\n<\/tt><strong>10<\/strong><tt>\n<\/tt>11<tt>\n<\/tt>12<tt>\n<\/tt>13<tt>\n<\/tt>14<tt>\n<\/tt><strong>15<\/strong><tt>\n<\/tt>16<tt>\n<\/tt>17<tt>\n<\/tt>18<tt>\n<\/tt>19<tt>\n<\/tt><strong>20<\/strong><tt>\n<\/tt><\/pre>\n<\/td>\n<td class=\"code\">\n<pre ondblclick=\"with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }\">  &gt;&gt; diff = {}<tt>\n<\/tt>  =&gt; {}<tt>\n<\/tt>  &gt;&gt; diff_a_1_2.each_with_index <span class=\"r\">do<\/span> |d,index|<tt>\n<\/tt>  <span class=\"i\">?&gt;<\/span> diff[d[<span class=\"i\">0<\/span>]] = [d[<span class=\"i\">1<\/span>],diff_a_2_1[index][<span class=\"i\">1<\/span>]]<tt>\n<\/tt>  &gt;&gt; <span class=\"r\">end<\/span>  <span class=\"c\">#=&gt; populates the diff<\/span><tt>\n<\/tt>  &gt;&gt; diff<tt>\n<\/tt>  =&gt; {<span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">updated_at<\/span><span class=\"dl\">&quot;<\/span><\/span>=&gt;[<span class=\"co\">Wed<\/span> <span class=\"co\">Apr<\/span> <span class=\"i\">11<\/span> <span class=\"i\">15<\/span>:<span class=\"i\">36<\/span>:<span class=\"i\">03<\/span> <span class=\"co\">MDT<\/span> <span class=\"i\">2007<\/span>, <tt>\n<\/tt>                     <span class=\"co\">Mon<\/span> <span class=\"co\">Apr<\/span> <span class=\"i\">09<\/span> <span class=\"i\">11<\/span>:<span class=\"i\">08<\/span>:<span class=\"i\">17<\/span> <span class=\"co\">MDT<\/span> <span class=\"i\">2007<\/span>], <tt>\n<\/tt>    <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">last_email_alert_at<\/span><span class=\"dl\">&quot;<\/span><\/span>=&gt;[<span class=\"co\">Wed<\/span> <span class=\"co\">Apr<\/span> <span class=\"i\">11<\/span> <span class=\"i\">15<\/span>:<span class=\"i\">36<\/span>:<span class=\"i\">03<\/span> <span class=\"co\">MDT<\/span> <span class=\"i\">2007<\/span>, <span class=\"pc\">nil<\/span>], <tt>\n<\/tt>    <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">id<\/span><span class=\"dl\">&quot;<\/span><\/span>=&gt;[<span class=\"i\">3<\/span>, <span class=\"i\">4<\/span>], <tt>\n<\/tt>    <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">description<\/span><span class=\"dl\">&quot;<\/span><\/span>=&gt;[<span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">hello<\/span><span class=\"dl\">&quot;<\/span><\/span>, <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">goodbye<\/span><span class=\"dl\">&quot;<\/span><\/span>], <tt>\n<\/tt>    <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">last_email_alert_by<\/span><span class=\"dl\">&quot;<\/span><\/span>=&gt;[<span class=\"i\">2<\/span>, <span class=\"pc\">nil<\/span>], <tt>\n<\/tt>    <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">summary<\/span><span class=\"dl\">&quot;<\/span><\/span>=&gt;[<span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Do this for me.....<\/span><span class=\"dl\">&quot;<\/span><\/span>,   <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Test<\/span><span class=\"dl\">&quot;<\/span><\/span>], <tt>\n<\/tt>    <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">version<\/span><span class=\"dl\">&quot;<\/span><\/span>=&gt;[<span class=\"i\">30<\/span>, <span class=\"i\">1<\/span>], <tt>\n<\/tt>    <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">due_date<\/span><span class=\"dl\">&quot;<\/span><\/span>=&gt;[<span class=\"c\">#&lt;Date: 4908383\/2,0,2299161&gt;, <\/span><tt>\n<\/tt>                 <span class=\"c\">#&lt;Date: 4908421\/2,0,2299161&gt;], <\/span><tt>\n<\/tt>    <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">created_at<\/span><span class=\"dl\">&quot;<\/span><\/span>=&gt;[<span class=\"co\">Mon<\/span> <span class=\"co\">Apr<\/span> <span class=\"i\">09<\/span> <span class=\"i\">10<\/span>:<span class=\"i\">58<\/span>:<span class=\"i\">24<\/span> <span class=\"co\">MDT<\/span> <span class=\"i\">2007<\/span>, <tt>\n<\/tt>                   <span class=\"co\">Mon<\/span> <span class=\"co\">Apr<\/span> <span class=\"i\">09<\/span> <span class=\"i\">11<\/span>:<span class=\"i\">08<\/span>:<span class=\"i\">17<\/span> <span class=\"co\">MDT<\/span> <span class=\"i\">2007<\/span>]}<tt>\n<\/tt>  &gt;&gt; diff.size<tt>\n<\/tt>  =&gt; <span class=\"i\">9<\/span> <tt>\n<\/tt><\/pre>\n<\/td>\n<\/tr>\n<\/table>\n<p>Now if you compare the results above with the results I showed for riff, they are almost identical, riff just takes the extra step of ignoring the differences between id, since that is implied.<\/p>\n","protected":false},"excerpt":{"rendered":"<p>The other day I went looking for a quick way to get a diff between revisions of a record for ActiveRecord. This led to the Riff plugin for Ruby on Rails. There are two uses of this plugin: object1.diff?(object2) #=> true | false object2.diff(object2) #=> hash of differences Here is an example: 1 2 3 [&hellip;]<\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[6,3,5],"tags":[],"_links":{"self":[{"href":"http:\/\/pullmonkey.com\/wp-json\/wp\/v2\/posts\/15"}],"collection":[{"href":"http:\/\/pullmonkey.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/pullmonkey.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/pullmonkey.com\/wp-json\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"http:\/\/pullmonkey.com\/wp-json\/wp\/v2\/comments?post=15"}],"version-history":[{"count":0,"href":"http:\/\/pullmonkey.com\/wp-json\/wp\/v2\/posts\/15\/revisions"}],"wp:attachment":[{"href":"http:\/\/pullmonkey.com\/wp-json\/wp\/v2\/media?parent=15"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/pullmonkey.com\/wp-json\/wp\/v2\/categories?post=15"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/pullmonkey.com\/wp-json\/wp\/v2\/tags?post=15"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}