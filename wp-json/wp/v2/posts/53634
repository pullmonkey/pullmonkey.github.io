{"id":53634,"date":"2009-04-30T14:48:00","date_gmt":"2009-04-30T14:48:00","guid":{"rendered":"\/2009\/04\/30\/spreadsheet-gem-data-may-have-been-lost"},"modified":"2009-08-30T00:06:43","modified_gmt":"2009-08-30T00:06:43","slug":"spreadsheet-gem-data-may-have-been-lost","status":"publish","type":"post","link":"http:\/\/pullmonkey.com\/2009\/04\/30\/spreadsheet-gem-data-may-have-been-lost\/","title":{"rendered":"Spreadsheet Gem &#8211; data may have been lost"},"content":{"rendered":"<p>I've been using the <a href=\"http:\/\/spreadsheet.rubyforge.org\/\">spreadsheet gem<\/a> lately for a couple projects I am working on to modify existing spreadsheets.  I have quite often stumbled upon this error when opening modified spreadsheets in excel:<\/p>\n<h2>File error: data may have been lost<\/h2>\n<p>Like most microsoft errors, it was useless and the spreadsheet came up just fine.  But that error was just so annoying, other spreadsheet applications (open office, excel on mac) opened without any problems.  So after quite a bit of hacking and digging around, I finally tried setting the encoding, which defaults to UTF-8.  Well it just so happens that the spreadsheet being modified was encoded with UTF-16LE.  <\/p>\n<p>So part one of my solution became this:<\/p>\n<table class=\"CodeRay\">\n<tr>\n<td class=\"line_numbers\" title=\"click to toggle\" onclick=\"with (this.firstChild.style) { display = (display == '') ? 'none' : '' }\">\n<pre>1<tt>\n<\/tt>2<tt>\n<\/tt><\/pre>\n<\/td>\n<td class=\"code\">\n<pre ondblclick=\"with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }\"><tt>\n<\/tt><span class=\"co\">Spreadsheet<\/span>.client_encoding = <span class=\"s\"><span class=\"dl\">'<\/span><span class=\"k\">UTF-16LE<\/span><span class=\"dl\">'<\/span><\/span><tt>\n<\/tt><\/pre>\n<\/td>\n<\/tr>\n<\/table>\n<p>Then doing a little more digging I decided that this would be a better long-term solution:<\/p>\n<table class=\"CodeRay\">\n<tr>\n<td class=\"line_numbers\" title=\"click to toggle\" onclick=\"with (this.firstChild.style) { display = (display == '') ? 'none' : '' }\">\n<pre>1<tt>\n<\/tt>2<tt>\n<\/tt>3<tt>\n<\/tt><\/pre>\n<\/td>\n<td class=\"code\">\n<pre ondblclick=\"with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }\"><tt>\n<\/tt>book = <span class=\"co\">Spreadsheet<\/span>.open spreadsheet_file<tt>\n<\/tt><span class=\"co\">Spreadsheet<\/span>.client_encoding = book.encoding<tt>\n<\/tt><\/pre>\n<\/td>\n<\/tr>\n<\/table>\n<p>Well, hopefully it wasn't just me and someone will be able to save a bit of time with this.<\/p>\n","protected":false},"excerpt":{"rendered":"<p>I&#8217;ve been using the spreadsheet gem lately for a couple projects I am working on to modify existing spreadsheets. I have quite often stumbled upon this error when opening modified spreadsheets in excel: File error: data may have been lost Like most microsoft errors, it was useless and the spreadsheet came up just fine. But [&hellip;]<\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[3,5,9],"tags":[46,44,210,211,43,45],"_links":{"self":[{"href":"http:\/\/pullmonkey.com\/wp-json\/wp\/v2\/posts\/53634"}],"collection":[{"href":"http:\/\/pullmonkey.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/pullmonkey.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/pullmonkey.com\/wp-json\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"http:\/\/pullmonkey.com\/wp-json\/wp\/v2\/comments?post=53634"}],"version-history":[{"count":1,"href":"http:\/\/pullmonkey.com\/wp-json\/wp\/v2\/posts\/53634\/revisions"}],"predecessor-version":[{"id":57306,"href":"http:\/\/pullmonkey.com\/wp-json\/wp\/v2\/posts\/53634\/revisions\/57306"}],"wp:attachment":[{"href":"http:\/\/pullmonkey.com\/wp-json\/wp\/v2\/media?parent=53634"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/pullmonkey.com\/wp-json\/wp\/v2\/categories?post=53634"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/pullmonkey.com\/wp-json\/wp\/v2\/tags?post=53634"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}