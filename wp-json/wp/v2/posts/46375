{"id":46375,"date":"2008-08-05T04:59:00","date_gmt":"2008-08-05T04:59:00","guid":{"rendered":"\/2008\/08\/05\/dynamic-select-boxes-many-to-many-ruby-on-rails"},"modified":"2009-08-30T04:40:55","modified_gmt":"2009-08-30T04:40:55","slug":"dynamic-select-boxes-many-to-many-ruby-on-rails","status":"publish","type":"post","link":"http:\/\/pullmonkey.com\/2008\/08\/05\/dynamic-select-boxes-many-to-many-ruby-on-rails\/","title":{"rendered":"Dynamic Select Boxes (many to many) &#8211; Ruby on Rails"},"content":{"rendered":"<p>I just got <a href=\"http:\/\/pullmonkey.com\/2008\/3\/30\/dynamic-select-boxes-ruby-on-rails#comment-46369\">comment asking how one would go about doing a many to many relation in this dynamic select box example<\/a>.  For example, what if an artist belongs to multiple genres. Here we go:<br \/>\n<a href=\"http:\/\/pullmonkey.com\/2008\/3\/30\/dynamic-select-boxes-ruby-on-rails\">The original tutorial<\/a>.<br \/>\nCreate your models and build your migrations:<\/p>\n<table class=\"CodeRay\">\n<tr>\n<td class=\"line_numbers\" title=\"click to toggle\" onclick=\"with (this.firstChild.style) { display = (display == '') ? 'none' : '' }\">\n<pre>1<tt>\n<\/tt>2<tt>\n<\/tt>3<tt>\n<\/tt>4<tt>\n<\/tt><strong>5<\/strong><tt>\n<\/tt><\/pre>\n<\/td>\n<td class=\"code\">\n<pre ondblclick=\"with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }\"><tt>\n<\/tt>ruby script\/generate model genre name<span class=\"sy\">:string<\/span><tt>\n<\/tt>ruby script\/generate model artist name<span class=\"sy\">:string<\/span>   <span class=\"c\"># no genre_id here, moved to association table<\/span><tt>\n<\/tt>ruby script\/generate model song title<span class=\"sy\">:string<\/span> artist_id<span class=\"sy\">:integer<\/span><tt>\n<\/tt>ruby script\/generate model artist_association artist_id<span class=\"sy\">:integer<\/span> genre_id<span class=\"sy\">:integer<\/span><tt>\n<\/tt><\/pre>\n<\/td>\n<\/tr>\n<\/table>\n<p>Populate your genres, artists and songs through a migration:<\/p>\n<table class=\"CodeRay\">\n<tr>\n<td class=\"line_numbers\" title=\"click to toggle\" onclick=\"with (this.firstChild.style) { display = (display == '') ? 'none' : '' }\">\n<pre>1<tt>\n<\/tt>2<tt>\n<\/tt><\/pre>\n<\/td>\n<td class=\"code\">\n<pre ondblclick=\"with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }\"><tt>\n<\/tt>ruby script\/generate migration create_hierarchy<tt>\n<\/tt><\/pre>\n<\/td>\n<\/tr>\n<\/table>\n<p>Contents of migration:<\/p>\n<table class=\"CodeRay\">\n<tr>\n<td class=\"line_numbers\" title=\"click to toggle\" onclick=\"with (this.firstChild.style) { display = (display == '') ? 'none' : '' }\">\n<pre>1<tt>\n<\/tt>2<tt>\n<\/tt>3<tt>\n<\/tt>4<tt>\n<\/tt><strong>5<\/strong><tt>\n<\/tt>6<tt>\n<\/tt>7<tt>\n<\/tt>8<tt>\n<\/tt>9<tt>\n<\/tt><strong>10<\/strong><tt>\n<\/tt>11<tt>\n<\/tt>12<tt>\n<\/tt>13<tt>\n<\/tt>14<tt>\n<\/tt><strong>15<\/strong><tt>\n<\/tt>16<tt>\n<\/tt>17<tt>\n<\/tt>18<tt>\n<\/tt>19<tt>\n<\/tt><strong>20<\/strong><tt>\n<\/tt>21<tt>\n<\/tt>22<tt>\n<\/tt>23<tt>\n<\/tt>24<tt>\n<\/tt><strong>25<\/strong><tt>\n<\/tt>26<tt>\n<\/tt>27<tt>\n<\/tt>28<tt>\n<\/tt>29<tt>\n<\/tt><strong>30<\/strong><tt>\n<\/tt>31<tt>\n<\/tt>32<tt>\n<\/tt>33<tt>\n<\/tt>34<tt>\n<\/tt><strong>35<\/strong><tt>\n<\/tt>36<tt>\n<\/tt>37<tt>\n<\/tt>38<tt>\n<\/tt>39<tt>\n<\/tt><strong>40<\/strong><tt>\n<\/tt>41<tt>\n<\/tt>42<tt>\n<\/tt>43<tt>\n<\/tt>44<tt>\n<\/tt><strong>45<\/strong><tt>\n<\/tt>46<tt>\n<\/tt><\/pre>\n<\/td>\n<td class=\"code\">\n<pre ondblclick=\"with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }\"><tt>\n<\/tt><span class=\"r\">class<\/span> <span class=\"cl\">CreateHierarchy<\/span> &lt; <span class=\"co\">ActiveRecord<\/span>::<span class=\"co\">Migration<\/span><tt>\n<\/tt>  <span class=\"r\">def<\/span> <span class=\"pc\">self<\/span>.up<tt>\n<\/tt>    <span class=\"c\"># same genres as before<\/span><tt>\n<\/tt>    g1 = <span class=\"co\">Genre<\/span>.create(<span class=\"sy\">:name<\/span> =&gt; <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Genre 1<\/span><span class=\"dl\">&quot;<\/span><\/span>)<tt>\n<\/tt>    g2 = <span class=\"co\">Genre<\/span>.create(<span class=\"sy\">:name<\/span> =&gt; <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Genre 2<\/span><span class=\"dl\">&quot;<\/span><\/span>)<tt>\n<\/tt>    g3 = <span class=\"co\">Genre<\/span>.create(<span class=\"sy\">:name<\/span> =&gt; <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Genre 3<\/span><span class=\"dl\">&quot;<\/span><\/span>)<tt>\n<\/tt><tt>\n<\/tt>    <span class=\"c\"># same artists as before, but without a genre_id<\/span><tt>\n<\/tt>    a1 = <span class=\"co\">Artist<\/span>.create(<span class=\"sy\">:name<\/span> =&gt; <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Artist 1<\/span><span class=\"dl\">&quot;<\/span><\/span>)<tt>\n<\/tt>    a2 = <span class=\"co\">Artist<\/span>.create(<span class=\"sy\">:name<\/span> =&gt; <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Artist 2<\/span><span class=\"dl\">&quot;<\/span><\/span>)<tt>\n<\/tt>    a3 = <span class=\"co\">Artist<\/span>.create(<span class=\"sy\">:name<\/span> =&gt; <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Artist 3<\/span><span class=\"dl\">&quot;<\/span><\/span>)<tt>\n<\/tt>    a4 = <span class=\"co\">Artist<\/span>.create(<span class=\"sy\">:name<\/span> =&gt; <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Artist 4<\/span><span class=\"dl\">&quot;<\/span><\/span>)<tt>\n<\/tt>    a5 = <span class=\"co\">Artist<\/span>.create(<span class=\"sy\">:name<\/span> =&gt; <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Artist 5<\/span><span class=\"dl\">&quot;<\/span><\/span>)<tt>\n<\/tt>    a6 = <span class=\"co\">Artist<\/span>.create(<span class=\"sy\">:name<\/span> =&gt; <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Artist 6<\/span><span class=\"dl\">&quot;<\/span><\/span>)<tt>\n<\/tt><tt>\n<\/tt>    <span class=\"c\"># now set which artists belong to which genres<\/span><tt>\n<\/tt>    <span class=\"c\"># Artist 1 belongs to all three genres<\/span><tt>\n<\/tt>    <span class=\"co\">ArtistAssociation<\/span>.create(<span class=\"sy\">:genre_id<\/span> =&gt; g1.id, <span class=\"sy\">:artist_id<\/span> =&gt; a1.id)<tt>\n<\/tt>    <span class=\"co\">ArtistAssociation<\/span>.create(<span class=\"sy\">:genre_id<\/span> =&gt; g2.id, <span class=\"sy\">:artist_id<\/span> =&gt; a1.id)<tt>\n<\/tt>    <span class=\"co\">ArtistAssociation<\/span>.create(<span class=\"sy\">:genre_id<\/span> =&gt; g3.id, <span class=\"sy\">:artist_id<\/span> =&gt; a1.id)<tt>\n<\/tt>   <span class=\"c\"># the rest of the artists only belong to one association<\/span><tt>\n<\/tt>    <span class=\"co\">ArtistAssociation<\/span>.create(<span class=\"sy\">:genre_id<\/span> =&gt; g1.id, <span class=\"sy\">:artist_id<\/span> =&gt; a2.id)<tt>\n<\/tt>    <span class=\"co\">ArtistAssociation<\/span>.create(<span class=\"sy\">:genre_id<\/span> =&gt; g2.id, <span class=\"sy\">:artist_id<\/span> =&gt; a3.id)<tt>\n<\/tt>    <span class=\"co\">ArtistAssociation<\/span>.create(<span class=\"sy\">:genre_id<\/span> =&gt; g2.id, <span class=\"sy\">:artist_id<\/span> =&gt; a4.id)<tt>\n<\/tt>    <span class=\"co\">ArtistAssociation<\/span>.create(<span class=\"sy\">:genre_id<\/span> =&gt; g3.id, <span class=\"sy\">:artist_id<\/span> =&gt; a5.id)<tt>\n<\/tt>    <span class=\"co\">ArtistAssociation<\/span>.create(<span class=\"sy\">:genre_id<\/span> =&gt; g3.id, <span class=\"sy\">:artist_id<\/span> =&gt; a6.id)<tt>\n<\/tt><tt>\n<\/tt>    <span class=\"co\">Song<\/span>.create(<span class=\"sy\">:title<\/span> =&gt; <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Song 1<\/span><span class=\"dl\">&quot;<\/span><\/span>,  <span class=\"sy\">:artist_id<\/span> =&gt; a1.id)<tt>\n<\/tt>    <span class=\"co\">Song<\/span>.create(<span class=\"sy\">:title<\/span> =&gt; <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Song 2<\/span><span class=\"dl\">&quot;<\/span><\/span>,  <span class=\"sy\">:artist_id<\/span> =&gt; a1.id)<tt>\n<\/tt>    <span class=\"co\">Song<\/span>.create(<span class=\"sy\">:title<\/span> =&gt; <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Song 3<\/span><span class=\"dl\">&quot;<\/span><\/span>,  <span class=\"sy\">:artist_id<\/span> =&gt; a2.id)<tt>\n<\/tt>    <span class=\"co\">Song<\/span>.create(<span class=\"sy\">:title<\/span> =&gt; <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Song 4<\/span><span class=\"dl\">&quot;<\/span><\/span>,  <span class=\"sy\">:artist_id<\/span> =&gt; a2.id)<tt>\n<\/tt>    <span class=\"co\">Song<\/span>.create(<span class=\"sy\">:title<\/span> =&gt; <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Song 5<\/span><span class=\"dl\">&quot;<\/span><\/span>,  <span class=\"sy\">:artist_id<\/span> =&gt; a3.id)<tt>\n<\/tt>    <span class=\"co\">Song<\/span>.create(<span class=\"sy\">:title<\/span> =&gt; <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Song 6<\/span><span class=\"dl\">&quot;<\/span><\/span>,  <span class=\"sy\">:artist_id<\/span> =&gt; a3.id)<tt>\n<\/tt>    <span class=\"co\">Song<\/span>.create(<span class=\"sy\">:title<\/span> =&gt; <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Song 7<\/span><span class=\"dl\">&quot;<\/span><\/span>,  <span class=\"sy\">:artist_id<\/span> =&gt; a4.id)<tt>\n<\/tt>    <span class=\"co\">Song<\/span>.create(<span class=\"sy\">:title<\/span> =&gt; <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Song 8<\/span><span class=\"dl\">&quot;<\/span><\/span>,  <span class=\"sy\">:artist_id<\/span> =&gt; a4.id)<tt>\n<\/tt>    <span class=\"co\">Song<\/span>.create(<span class=\"sy\">:title<\/span> =&gt; <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Song 9<\/span><span class=\"dl\">&quot;<\/span><\/span>,  <span class=\"sy\">:artist_id<\/span> =&gt; a5.id)<tt>\n<\/tt>    <span class=\"co\">Song<\/span>.create(<span class=\"sy\">:title<\/span> =&gt; <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Song 10<\/span><span class=\"dl\">&quot;<\/span><\/span>, <span class=\"sy\">:artist_id<\/span> =&gt; a5.id)<tt>\n<\/tt>    <span class=\"co\">Song<\/span>.create(<span class=\"sy\">:title<\/span> =&gt; <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Song 11<\/span><span class=\"dl\">&quot;<\/span><\/span>, <span class=\"sy\">:artist_id<\/span> =&gt; a6.id)<tt>\n<\/tt>    <span class=\"co\">Song<\/span>.create(<span class=\"sy\">:title<\/span> =&gt; <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Song 12<\/span><span class=\"dl\">&quot;<\/span><\/span>, <span class=\"sy\">:artist_id<\/span> =&gt; a6.id)<tt>\n<\/tt>  <span class=\"r\">end<\/span><tt>\n<\/tt><tt>\n<\/tt>  <span class=\"r\">def<\/span> <span class=\"pc\">self<\/span>.down<tt>\n<\/tt><span class=\"c\"># you can fill this in if you want.<\/span><tt>\n<\/tt>  <span class=\"r\">end<\/span><tt>\n<\/tt><span class=\"r\">end<\/span><tt>\n<\/tt><\/pre>\n<\/td>\n<\/tr>\n<\/table>\n<p>So now we need to populate the database:<\/p>\n<table class=\"CodeRay\">\n<tr>\n<td class=\"line_numbers\" title=\"click to toggle\" onclick=\"with (this.firstChild.style) { display = (display == '') ? 'none' : '' }\">\n<pre>1<tt>\n<\/tt>2<tt>\n<\/tt><\/pre>\n<\/td>\n<td class=\"code\">\n<pre ondblclick=\"with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }\"><tt>\n<\/tt>rake db<span class=\"sy\">:migrate<\/span><tt>\n<\/tt><\/pre>\n<\/td>\n<\/tr>\n<\/table>\n<p>Now we need to modify our models to set up the associations.<\/p>\n<table class=\"CodeRay\">\n<tr>\n<td class=\"line_numbers\" title=\"click to toggle\" onclick=\"with (this.firstChild.style) { display = (display == '') ? 'none' : '' }\">\n<pre>1<tt>\n<\/tt>2<tt>\n<\/tt>3<tt>\n<\/tt>4<tt>\n<\/tt><strong>5<\/strong><tt>\n<\/tt>6<tt>\n<\/tt>7<tt>\n<\/tt>8<tt>\n<\/tt>9<tt>\n<\/tt><strong>10<\/strong><tt>\n<\/tt>11<tt>\n<\/tt>12<tt>\n<\/tt>13<tt>\n<\/tt>14<tt>\n<\/tt><strong>15<\/strong><tt>\n<\/tt>16<tt>\n<\/tt>17<tt>\n<\/tt>18<tt>\n<\/tt>19<tt>\n<\/tt><strong>20<\/strong><tt>\n<\/tt>21<tt>\n<\/tt><\/pre>\n<\/td>\n<td class=\"code\">\n<pre ondblclick=\"with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }\"><tt>\n<\/tt><span class=\"r\">class<\/span> <span class=\"cl\">Genre<\/span> &lt; <span class=\"co\">ActiveRecord<\/span>::<span class=\"co\">Base<\/span><tt>\n<\/tt>  has_many <span class=\"sy\">:artist_associations<\/span><tt>\n<\/tt>  has_many <span class=\"sy\">:artists<\/span>, <span class=\"sy\">:through<\/span> =&gt; <span class=\"sy\">:artist_associations<\/span><tt>\n<\/tt>  <span class=\"c\"># CAN&quot;T NEST HMTs .....  has_many :songs, :through =&gt; :artists<\/span><tt>\n<\/tt>  <span class=\"c\"># do it by hand ... argh<\/span><tt>\n<\/tt>  <span class=\"r\">def<\/span> <span class=\"fu\">songs<\/span><tt>\n<\/tt>    artists.map{|a| a.songs}.flatten<tt>\n<\/tt>  <span class=\"r\">end<\/span><tt>\n<\/tt><span class=\"r\">end<\/span><tt>\n<\/tt><tt>\n<\/tt><span class=\"r\">class<\/span> <span class=\"cl\">Artist<\/span> &lt; <span class=\"co\">ActiveRecord<\/span>::<span class=\"co\">Base<\/span><tt>\n<\/tt>  has_many <span class=\"sy\">:artist_associations<\/span><tt>\n<\/tt>  has_many <span class=\"sy\">:genres<\/span>, <span class=\"sy\">:through<\/span> =&gt; <span class=\"sy\">:artist_associations<\/span><tt>\n<\/tt>  has_many <span class=\"sy\">:songs<\/span><tt>\n<\/tt><span class=\"r\">end<\/span><tt>\n<\/tt><tt>\n<\/tt><span class=\"r\">class<\/span> <span class=\"cl\">ArtistAssociation<\/span> &lt; <span class=\"co\">ActiveRecord<\/span>::<span class=\"co\">Base<\/span><tt>\n<\/tt>  belongs_to <span class=\"sy\">:artist<\/span><tt>\n<\/tt>  belongs_to <span class=\"sy\">:genre<\/span><tt>\n<\/tt><span class=\"r\">end<\/span><tt>\n<\/tt><\/pre>\n<\/td>\n<\/tr>\n<\/table>\n<p>That should be it for the many to many relationship.<\/p>\n<p>Everything else is the same as in <a href=\"http:\/\/pullmonkey.com\/2008\/3\/30\/dynamic-select-boxes-ruby-on-rails\">the last tutorial<\/a>.<br \/>\n# the controller<\/p>\n<table class=\"CodeRay\">\n<tr>\n<td class=\"line_numbers\" title=\"click to toggle\" onclick=\"with (this.firstChild.style) { display = (display == '') ? 'none' : '' }\">\n<pre>1<tt>\n<\/tt>2<tt>\n<\/tt>3<tt>\n<\/tt>4<tt>\n<\/tt><strong>5<\/strong><tt>\n<\/tt>6<tt>\n<\/tt>7<tt>\n<\/tt>8<tt>\n<\/tt>9<tt>\n<\/tt><strong>10<\/strong><tt>\n<\/tt>11<tt>\n<\/tt>12<tt>\n<\/tt>13<tt>\n<\/tt>14<tt>\n<\/tt><strong>15<\/strong><tt>\n<\/tt>16<tt>\n<\/tt>17<tt>\n<\/tt>18<tt>\n<\/tt>19<tt>\n<\/tt><strong>20<\/strong><tt>\n<\/tt>21<tt>\n<\/tt>22<tt>\n<\/tt>23<tt>\n<\/tt>24<tt>\n<\/tt><strong>25<\/strong><tt>\n<\/tt>26<tt>\n<\/tt>27<tt>\n<\/tt>28<tt>\n<\/tt>29<tt>\n<\/tt><strong>30<\/strong><tt>\n<\/tt><\/pre>\n<\/td>\n<td class=\"code\">\n<pre ondblclick=\"with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }\"><tt>\n<\/tt><span class=\"r\">class<\/span> <span class=\"cl\">TestItController<\/span> &lt; <span class=\"co\">ApplicationController<\/span><tt>\n<\/tt>  <span class=\"r\">def<\/span> <span class=\"fu\">index<\/span><tt>\n<\/tt>    <span class=\"iv\">@genres<\/span>  = <span class=\"co\">Genre<\/span>.find(<span class=\"sy\">:all<\/span>)<tt>\n<\/tt>    <span class=\"iv\">@artists<\/span> = <span class=\"co\">Artist<\/span>.find(<span class=\"sy\">:all<\/span>)<tt>\n<\/tt>    <span class=\"iv\">@songs<\/span>   = <span class=\"co\">Song<\/span>.find(<span class=\"sy\">:all<\/span>)<tt>\n<\/tt>  <span class=\"r\">end<\/span><tt>\n<\/tt><tt>\n<\/tt>  <span class=\"r\">def<\/span> <span class=\"fu\">update_artists<\/span><tt>\n<\/tt>    <span class=\"c\"># updates artists and songs based on genre selected<\/span><tt>\n<\/tt>    genre = <span class=\"co\">Genre<\/span>.find(params[<span class=\"sy\">:genre_id<\/span>])<tt>\n<\/tt>    artists = genre.artists<tt>\n<\/tt>    songs   = genre.songs<tt>\n<\/tt><tt>\n<\/tt>    render <span class=\"sy\">:update<\/span> <span class=\"r\">do<\/span> |page|<tt>\n<\/tt>      page.replace_html <span class=\"s\"><span class=\"dl\">'<\/span><span class=\"k\">artists<\/span><span class=\"dl\">'<\/span><\/span>, <span class=\"sy\">:partial<\/span> =&gt; <span class=\"s\"><span class=\"dl\">'<\/span><span class=\"k\">artists<\/span><span class=\"dl\">'<\/span><\/span>, <span class=\"sy\">:object<\/span> =&gt; artists<tt>\n<\/tt>      page.replace_html <span class=\"s\"><span class=\"dl\">'<\/span><span class=\"k\">songs<\/span><span class=\"dl\">'<\/span><\/span>,   <span class=\"sy\">:partial<\/span> =&gt; <span class=\"s\"><span class=\"dl\">'<\/span><span class=\"k\">songs<\/span><span class=\"dl\">'<\/span><\/span>,   <span class=\"sy\">:object<\/span> =&gt; songs<tt>\n<\/tt>    <span class=\"r\">end<\/span><tt>\n<\/tt>  <span class=\"r\">end<\/span><tt>\n<\/tt><tt>\n<\/tt>  <span class=\"r\">def<\/span> <span class=\"fu\">update_songs<\/span><tt>\n<\/tt>    <span class=\"c\"># updates songs based on artist selected<\/span><tt>\n<\/tt>    artist = <span class=\"co\">Artist<\/span>.find(params[<span class=\"sy\">:artist_id<\/span>])<tt>\n<\/tt>    songs  = artist.songs<tt>\n<\/tt><tt>\n<\/tt>    render <span class=\"sy\">:update<\/span> <span class=\"r\">do<\/span> |page|<tt>\n<\/tt>      page.replace_html <span class=\"s\"><span class=\"dl\">'<\/span><span class=\"k\">songs<\/span><span class=\"dl\">'<\/span><\/span>, <span class=\"sy\">:partial<\/span> =&gt; <span class=\"s\"><span class=\"dl\">'<\/span><span class=\"k\">songs<\/span><span class=\"dl\">'<\/span><\/span>, <span class=\"sy\">:object<\/span> =&gt; songs<tt>\n<\/tt>    <span class=\"r\">end<\/span><tt>\n<\/tt>  <span class=\"r\">end<\/span><tt>\n<\/tt><span class=\"r\">end<\/span><tt>\n<\/tt><\/pre>\n<\/td>\n<\/tr>\n<\/table>\n<p>Now as far as views go we have one view (index.html.erb) and two partials (_songs and _artists).  Let's take a look at those:<br \/>\n# the _songs partial (_songs.html.erb):<\/p>\n<table class=\"CodeRay\">\n<tr>\n<td class=\"line_numbers\" title=\"click to toggle\" onclick=\"with (this.firstChild.style) { display = (display == '') ? 'none' : '' }\">\n<pre>1<tt>\n<\/tt>2<tt>\n<\/tt>3<tt>\n<\/tt><\/pre>\n<\/td>\n<td class=\"code\">\n<pre ondblclick=\"with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }\"><tt>\n<\/tt>&lt;%= collection_select(<span class=\"pc\">nil<\/span>, <span class=\"sy\">:song_id<\/span>, songs, <span class=\"sy\">:id<\/span>, <span class=\"sy\">:title<\/span>,<tt>\n<\/tt>                     {<span class=\"sy\">:prompt<\/span>   =&gt; <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Select a Song<\/span><span class=\"dl\">&quot;<\/span><\/span>}) <span class=\"s\"><span class=\"dl\">%&gt;<\/span><span class=\"k\"><tt>\n<\/tt><\/span><\/span><\/pre>\n<\/td>\n<\/tr>\n<\/table>\n<p># the _artists partial (_artists.html.erb):<\/p>\n<table class=\"CodeRay\">\n<tr>\n<td class=\"line_numbers\" title=\"click to toggle\" onclick=\"with (this.firstChild.style) { display = (display == '') ? 'none' : '' }\">\n<pre>1<tt>\n<\/tt>2<tt>\n<\/tt>3<tt>\n<\/tt>4<tt>\n<\/tt><strong>5<\/strong><tt>\n<\/tt>6<tt>\n<\/tt><\/pre>\n<\/td>\n<td class=\"code\">\n<pre ondblclick=\"with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }\"><tt>\n<\/tt>&lt;%= collection_select(<span class=\"pc\">nil<\/span>, <span class=\"sy\">:artist_id<\/span>, artists, <span class=\"sy\">:id<\/span>, <span class=\"sy\">:name<\/span>,<tt>\n<\/tt>                     {<span class=\"sy\">:prompt<\/span>   =&gt; <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Select an Artist<\/span><span class=\"dl\">&quot;<\/span><\/span>},<tt>\n<\/tt>                     {<span class=\"sy\">:onchange<\/span> =&gt; <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"il\"><span class=\"dl\">#{<\/span>remote_function(<span class=\"sy\">:url<\/span>  =&gt; {<span class=\"sy\">:action<\/span> =&gt; <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">update_songs<\/span><span class=\"dl\">&quot;<\/span><\/span>},<tt>\n<\/tt>                                                      <span class=\"sy\">:with<\/span> =&gt; <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">'artist_id='+value<\/span><span class=\"dl\">&quot;<\/span><\/span>)<span class=\"dl\">}<\/span><\/span><span class=\"dl\">&quot;<\/span><\/span>}) <span class=\"s\"><span class=\"dl\">%&gt;<\/span><span class=\"k\"><tt>\n<\/tt>&lt;br\/<\/span><span class=\"dl\">&gt;<\/span><\/span><tt>\n<\/tt><\/pre>\n<\/td>\n<\/tr>\n<\/table>\n<p># and last, but not least, the index view (index.html.erb):<\/p>\n<table class=\"CodeRay\">\n<tr>\n<td class=\"line_numbers\" title=\"click to toggle\" onclick=\"with (this.firstChild.style) { display = (display == '') ? 'none' : '' }\">\n<pre>1<tt>\n<\/tt>2<tt>\n<\/tt>3<tt>\n<\/tt>4<tt>\n<\/tt><strong>5<\/strong><tt>\n<\/tt>6<tt>\n<\/tt>7<tt>\n<\/tt>8<tt>\n<\/tt>9<tt>\n<\/tt><\/pre>\n<\/td>\n<td class=\"code\">\n<pre ondblclick=\"with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }\"><tt>\n<\/tt>&lt;%= javascript_include_tag <span class=\"sy\">:defaults<\/span> <span class=\"s\"><span class=\"dl\">%&gt;<\/span><span class=\"k\"><tt>\n<\/tt>&lt;%= collection_select(nil, :genre_id,  @genres,  :id, :name,<tt>\n<\/tt>                      {:prompt   =<\/span><span class=\"dl\">&gt;<\/span><\/span> <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">Select a Genre<\/span><span class=\"dl\">&quot;<\/span><\/span>},<tt>\n<\/tt>                      {<span class=\"sy\">:onchange<\/span> =&gt; <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"il\"><span class=\"dl\">#{<\/span>remote_function(<span class=\"sy\">:url<\/span>  =&gt; {<span class=\"sy\">:action<\/span> =&gt; <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">update_artists<\/span><span class=\"dl\">&quot;<\/span><\/span>},<tt>\n<\/tt>                                                       <span class=\"sy\">:with<\/span> =&gt; <span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">'genre_id='+value<\/span><span class=\"dl\">&quot;<\/span><\/span>)<span class=\"dl\">}<\/span><\/span><span class=\"dl\">&quot;<\/span><\/span>}) <span class=\"s\"><span class=\"dl\">%&gt;<\/span><span class=\"k\"><tt>\n<\/tt>&lt;br\/<\/span><span class=\"dl\">&gt;<\/span><\/span><tt>\n<\/tt>&lt;div id=<span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">artists<\/span><span class=\"dl\">&quot;<\/span><\/span>&gt;&lt;%= render <span class=\"sy\">:partial<\/span> =&gt; <span class=\"s\"><span class=\"dl\">'<\/span><span class=\"k\">artists<\/span><span class=\"dl\">'<\/span><\/span>, <span class=\"sy\">:object<\/span> =&gt; <span class=\"iv\">@artists<\/span> <span class=\"s\"><span class=\"dl\">%&gt;<\/span><span class=\"k\">&lt;\/div<\/span><span class=\"dl\">&gt;<\/span><\/span><tt>\n<\/tt>&lt;div id=<span class=\"s\"><span class=\"dl\">&quot;<\/span><span class=\"k\">songs<\/span><span class=\"dl\">&quot;<\/span><\/span>&gt;&lt;%= render <span class=\"sy\">:partial<\/span> =&gt; <span class=\"s\"><span class=\"dl\">'<\/span><span class=\"k\">songs<\/span><span class=\"dl\">'<\/span><\/span>,   <span class=\"sy\">:object<\/span> =&gt; <span class=\"iv\">@songs<\/span> <span class=\"s\"><span class=\"dl\">%&gt;<\/span><span class=\"k\">&lt;\/div<\/span><span class=\"dl\">&gt;<\/span><\/span><tt>\n<\/tt><\/pre>\n<\/td>\n<\/tr>\n<\/table>\n","protected":false},"excerpt":{"rendered":"<p>I just got comment asking how one would go about doing a many to many relation in this dynamic select box example. For example, what if an artist belongs to multiple genres. Here we go: The original tutorial. Create your models and build your migrations: 1 2 3 4 5 ruby script\/generate model genre name:string [&hellip;]<\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[6,3,5,9,30],"tags":[58,56,210,211,43,59,57],"_links":{"self":[{"href":"http:\/\/pullmonkey.com\/wp-json\/wp\/v2\/posts\/46375"}],"collection":[{"href":"http:\/\/pullmonkey.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/pullmonkey.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/pullmonkey.com\/wp-json\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"http:\/\/pullmonkey.com\/wp-json\/wp\/v2\/comments?post=46375"}],"version-history":[{"count":1,"href":"http:\/\/pullmonkey.com\/wp-json\/wp\/v2\/posts\/46375\/revisions"}],"predecessor-version":[{"id":57356,"href":"http:\/\/pullmonkey.com\/wp-json\/wp\/v2\/posts\/46375\/revisions\/57356"}],"wp:attachment":[{"href":"http:\/\/pullmonkey.com\/wp-json\/wp\/v2\/media?parent=46375"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/pullmonkey.com\/wp-json\/wp\/v2\/categories?post=46375"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/pullmonkey.com\/wp-json\/wp\/v2\/tags?post=46375"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}