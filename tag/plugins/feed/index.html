<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>plugins &#8211; PullMonkey Blog</title>
	<atom:link href="http://pullmonkey.com/tag/plugins/feed/" rel="self" type="application/rss+xml" />
	<link>http://pullmonkey.com</link>
	<description></description>
	<lastBuildDate>Wed, 06 Jan 2010 21:20:06 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>https://wordpress.org/?v=5.6</generator>
	<item>
		<title>POST OFC Graph as Image</title>
		<link>http://pullmonkey.com/2010/01/06/post_ofc_graph_as_image/</link>
					<comments>http://pullmonkey.com/2010/01/06/post_ofc_graph_as_image/#comments</comments>
		
		<dc:creator><![CDATA[charlie]]></dc:creator>
		<pubDate>Wed, 06 Jan 2010 21:17:57 +0000</pubDate>
				<category><![CDATA[development]]></category>
		<category><![CDATA[Javascript]]></category>
		<category><![CDATA[me]]></category>
		<category><![CDATA[Open Flash Chart Graphs]]></category>
		<category><![CDATA[plugins]]></category>
		<category><![CDATA[projects]]></category>
		<category><![CDATA[rails]]></category>
		<category><![CDATA[ruby]]></category>
		<category><![CDATA[SimpleCMS]]></category>
		<category><![CDATA[tutorials]]></category>
		<category><![CDATA[charts]]></category>
		<category><![CDATA[graphs]]></category>
		<category><![CDATA[image]]></category>
		<category><![CDATA[open flash chart]]></category>
		<category><![CDATA[png]]></category>
		<category><![CDATA[ruby on rails]]></category>
		<guid isPermaLink="false">http://pullmonkey.com/?p=57469</guid>

					<description><![CDATA[I was asked recently (well sort of) to give an example of saving an image to the server. If you look at teethgrinder's example for this, you will see that he has made available an external interface to do just that - POST your graph as png raw data to your server for storage. This [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>I was <a href="http://github.com/inbox/365812#reply">asked recently (well sort of) to give an example of saving an image to the server</a>.  If you look at <a href="http://teethgrinder.co.uk/open-flash-chart-2/adv-upload-image.php">teethgrinder's example for this</a>, you will see that he has made available an external interface to do just that - POST your graph as png raw data to your server for storage.  This has many benefits such as saving the image for use in a PDF report or for printing, since we know at times it is a bit troublesome to print the embedded flash object.<br />
I think the main problem people are having with this is the receiving of the image data post - see the upload_image method below.  Also, teethgrinder's example never really says where to make the post_image() call.  So I touch on both in the code below.<br />
Here is an example of the png that is saved when I did this for the chart in the previous example:<br />
<img loading="lazy" src="http://pullmonkey.com/wp-content/uploads/2010/01/tmp_image.png" alt="OFC Saved Image" title="OFC Saved Image" width="550" height="300" class="aligncenter size-full wp-image-57468" srcset="http://pullmonkey.com/wp-content/uploads/2010/01/tmp_image.png 550w, http://pullmonkey.com/wp-content/uploads/2010/01/tmp_image-300x163.png 300w" sizes="(max-width: 550px) 100vw, 550px" /></p>
<p>Well, let's just get right in to the code.<br />
The controller contains the same code as <a href="http://pullmonkey.com/2010/01/05/open-flash-chart-ii-x-axis-date-and-time/">my last post</a> with only a few minor changes to the index method and the addition of the upload_image method.<br />
In the <b>controller</b>, I have this:</p>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt>5<tt>
</tt>6<tt>
</tt>7<tt>
</tt>8<tt>
</tt>9<tt>
</tt><strong>10</strong><tt>
</tt>11<tt>
</tt>12<tt>
</tt>13<tt>
</tt>14<tt>
</tt>15<tt>
</tt>16<tt>
</tt>17<tt>
</tt>18<tt>
</tt>19<tt>
</tt><strong>20</strong><tt>
</tt>21<tt>
</tt>22<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }"><span style="color:#080;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">TestItController</span> &lt; <span style="color:#036;font-weight:bold">ApplicationController</span><tt>
</tt>  <span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">index</span><tt>
</tt>    <span style="color:#888"># note the user of open_flash_chart_object_from_hash instead of just open_flash_chart_object</span><tt>
</tt>    <span style="color:#888"># this allows you to pass in the id of the div you want the the chart to be in</span><tt>
</tt>    <span style="color:#888"># this is useful for when we need to findSWF by this id</span><tt>
</tt>    <span style="color:#33B">@graph</span> = open_flash_chart_object_from_hash(<span style="background-color:#fff0f0;color:#D20"><span style="color:#710">&quot;</span><span style="">/test_it/chart</span><span style="color:#710">&quot;</span></span>, <span style="color:#A60">:div_name</span> =&gt; <span style="background-color:#fff0f0;color:#D20"><span style="color:#710">&quot;</span><span style="">my_chart</span><span style="color:#710">&quot;</span></span>)<tt>
</tt>  <span style="color:#080;font-weight:bold">end</span><tt>
</tt><tt>
</tt>  <span style="color:#888"># added to recieve the post data for the OFC png image of the OFC graph</span><tt>
</tt>  <span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">upload_image</span><tt>
</tt>    name = <span style="background-color:#fff0f0;color:#D20"><span style="color:#710">&quot;</span><span style="">tmp_image.png</span><span style="color:#710">&quot;</span></span> || params[<span style="color:#A60">:name</span>]<tt>
</tt>    <span style="color:#888"># the save_image method that is provided by the OFC swf file sends raw post data, so get to it like this</span><tt>
</tt>    data = request.raw_post<tt>
</tt>    <span style="color:#036;font-weight:bold">File</span>.open(<span style="background-color:#fff0f0;color:#D20"><span style="color:#710">&quot;</span><span style="background:#ddd;color:black"><span style="background:#ddd;font-weight:bold;color:#666">#{</span><span style="color:#036;font-weight:bold">RAILS_ROOT</span><span style="background:#ddd;font-weight:bold;color:#666">}</span></span><span style="">/tmp/</span><span style="background:#ddd;color:black"><span style="background:#ddd;font-weight:bold;color:#666">#{</span>name<span style="background:#ddd;font-weight:bold;color:#666">}</span></span><span style="color:#710">&quot;</span></span>, <span style="background-color:#fff0f0;color:#D20"><span style="color:#710">&quot;</span><span style="">wb</span><span style="color:#710">&quot;</span></span>) { |f| f.write(data) } <span style="color:#080;font-weight:bold">if</span> data<tt>
</tt>    render <span style="color:#A60">:nothing</span> =&gt; <span style="color:#038;font-weight:bold">true</span><tt>
</tt>  <span style="color:#080;font-weight:bold">end</span><tt>
</tt><tt>
</tt>  <span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">chart</span><tt>
</tt>    <span style="color:#888"># same code from here - http://pullmonkey.com/2010/01/05/open-flash-chart-ii-x-axis-date-and-time/ </span><tt>
</tt>    ...<tt>
</tt>  <span style="color:#080;font-weight:bold">end</span><tt>
</tt><span style="color:#080;font-weight:bold">end</span></pre>
</td>
</tr>
</table>
<p>So just <b>note</b> the use of open_flash_chart_object_from_hash() in the index method, this way we can pass in the id of the div.<br />
In the <b>view</b>, I have this:</p>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt>5<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }">&lt;<span style="background-color:#fff0f0;color:#D20"><span style="color:#710">%=</span><span style=""> javascript_include_tag 'swfobject.js' %&gt;<tt>
</tt>&lt;%</span><span style="color:#710">=</span></span> <span style="color:#33B">@graph</span> %&gt;<tt>
</tt>&lt;<span style="background-color:#fff0f0;color:#D20"><span style="color:#710">%=</span><span style=""> save_as_image(&quot;http://localhost:3000/test_it/upload_image?name</span><span style="color:#710">=</span></span>tmp.png<span style="background-color:#fff0f0;color:#D20"><span style="color:#710">&quot;</span><span style="">, :id =&gt; </span><span style="color:#710">&quot;</span></span>my_chart<span style="background-color:#fff0f0;color:#D20"><span style="color:#710">&quot;</span><span style="">) %&gt;<tt>
</tt>&lt;br/&gt;<tt>
</tt>&lt;%= button_to_function </span><span style="color:#710">&quot;</span></span><span style="color:#036;font-weight:bold">Save</span> <span style="color:#036;font-weight:bold">Image</span><span style="background-color:#fff0f0;color:#D20"><span style="color:#710">&quot;</span><span style="">, </span><span style="color:#710">&quot;</span></span>post_image()<span style="background-color:#fff0f0;color:#D20"><span style="color:#710">&quot;</span><span style=""> %&gt;</span></span></pre>
</td>
</tr>
</table>
<p>
Really the only difference from what we would normally have in our view is that I am using the save image setup method that was added to the <a href="http://github.com/pullmonkey/open_flash_chart/commit/14ff9735c67e9b424caa129e8e06dc910e73681f">open flash chart ruby on rails plugin</a> in the last couple hours (as of this post).  The save_image method takes some arguments, mainly the url to post the image data to and the id of the chart we setup in the controller.</p>
]]></content:encoded>
					
					<wfw:commentRss>http://pullmonkey.com/2010/01/06/post_ofc_graph_as_image/feed/</wfw:commentRss>
			<slash:comments>2</slash:comments>
		
		
			</item>
		<item>
		<title>Open Flash Chart II for Ruby on Rails &#8211; Lug Wyrm Charmer</title>
		<link>http://pullmonkey.com/2010/01/04/open-flash-chart-ii-for-ruby-on-rails-lug-wyrm-charmer-version/</link>
					<comments>http://pullmonkey.com/2010/01/04/open-flash-chart-ii-for-ruby-on-rails-lug-wyrm-charmer-version/#comments</comments>
		
		<dc:creator><![CDATA[charlie]]></dc:creator>
		<pubDate>Mon, 04 Jan 2010 17:26:43 +0000</pubDate>
				<category><![CDATA[development]]></category>
		<category><![CDATA[Open Flash Chart Graphs]]></category>
		<category><![CDATA[plugins]]></category>
		<category><![CDATA[projects]]></category>
		<category><![CDATA[rails]]></category>
		<category><![CDATA[ruby]]></category>
		<category><![CDATA[charting]]></category>
		<category><![CDATA[graphs]]></category>
		<category><![CDATA[OFC]]></category>
		<category><![CDATA[OFCII]]></category>
		<category><![CDATA[open flash chart]]></category>
		<category><![CDATA[open flash chart II]]></category>
		<category><![CDATA[openflashchart]]></category>
		<category><![CDATA[plugin]]></category>
		<guid isPermaLink="false">http://pullmonkey.com/?p=57440</guid>

					<description><![CDATA[A long time overdue, but I've managed to get everything updated to the new version of Teethgrinder's open flash chart. I've also started tagging everything, so if you notice any problems trying to do anything from Teethgrinder's examples, then first check that you are using the latest (as of now, that is Lug Wyrm Charmer) [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>A long time overdue, but I've managed to get everything updated to the new version of <a href="http://teethgrinder.co.uk/open-flash-chart-2/">Teethgrinder's open flash chart</a>.</p>
<p>I've also started tagging everything, so if you notice any problems trying to do anything from <a href="http://teethgrinder.co.uk/open-flash-chart-2/tutorial.php">Teethgrinder's examples</a>, then first check that you are using the latest (as of now, that is Lug Wyrm Charmer) - <a href="http://github.com/pullmonkey/open_flash_chart/tree/LugWyrmCharmer">http://github.com/pullmonkey/open_flash_chart/tree/LugWyrmCharmer</a>.</p>
<p>Make sure you are using the latest swf either from the plugin assets directory or from <a href="http://teethgrinder.co.uk/open-flash-chart-2/downloads.php">Teethgrinder's downloads</a>.</p>
]]></content:encoded>
					
					<wfw:commentRss>http://pullmonkey.com/2010/01/04/open-flash-chart-ii-for-ruby-on-rails-lug-wyrm-charmer-version/feed/</wfw:commentRss>
			<slash:comments>2</slash:comments>
		
		
			</item>
		<item>
		<title>Blog plugin tutorial for Ruby on Rails</title>
		<link>http://pullmonkey.com/2009/02/11/blog-plugin-tutorial-for-ruby-on-rails/</link>
					<comments>http://pullmonkey.com/2009/02/11/blog-plugin-tutorial-for-ruby-on-rails/#comments</comments>
		
		<dc:creator><![CDATA[charlie]]></dc:creator>
		<pubDate>Wed, 11 Feb 2009 20:27:00 +0000</pubDate>
				<category><![CDATA[development]]></category>
		<category><![CDATA[Home]]></category>
		<category><![CDATA[rails]]></category>
		<category><![CDATA[tutorials]]></category>
		<category><![CDATA[plugins]]></category>
		<category><![CDATA[ruby]]></category>
		<category><![CDATA[ruby on rails]]></category>
		<category><![CDATA[tutorial]]></category>
		<guid isPermaLink="false">/2009/04/02/blog-plugin-tutorial-for-ruby-on-rails</guid>

					<description><![CDATA[Update: Bloggity does not require the Engines plugin to run if you are using Rails 2.3 or above (where the Engines plugin is baked in). -- Noted below by Bill. Update: Added the plugin to github - simple_blog. It is not production ready or really all that usable quite yet. Ok, so this a rant [&#8230;]]]></description>
										<content:encoded><![CDATA[<p><b>Update:</b> Bloggity does not require the Engines plugin to run if you are using Rails 2.3 or above (where the Engines plugin is baked in). -- Noted below by Bill.<br />
<br /><b>Update:</b> Added the plugin to github - <a href="http://github.com/pullmonkey/simple_blog/tree/master">simple_blog</a>.  It is not production ready or really all that usable quite yet.</p>
<p>Ok, so this a rant and I am sorry for that - but as simple as it is, I have been looking for a blog plugin lately.  The problem with the plugins I find is that I don't want to have to deal with the engines plugin or have the controllers, models, views, etc ... all extracted into my applications code.  I want it all external (hence a plugin) but let it be minimally configurable.</p>
<p>So in my recent search for a blog plugin for rails, I came across two that look very useful, but each with their flaws:<br />
1) <a href="http://github.com/vigetlabs/bloget/tree/master">bloget</a> - Everything is extracted to my code space.  Why?  Yes, I realize that it is most likely because I will want to override things, but get out of my space and keep to yourself!  <img src="https://s.w.org/images/core/emoji/13.0.1/72x72/1f642.png" alt="🙂" class="wp-smiley" style="height: 1em; max-height: 1em;" /> <br />
Provide me a way to override things that I would need to (there really shouldn't be too many), after all it is ruby.<br />
2) <a href="http://www.williambharding.com/blog/rails/bloggity-an-evolving-rails-blog-plugin/">bloggity</a> - Uses the engines plugin! I have nothing against the engines plugin (I think it is well written and documented) but for a freaking blog plugin?!?  Why? </p>
<p>Is there a third option?<br />
Glad you asked - yes, there is a third option - I hate to say it, but do it right!  There's your third option.<br />
Ok, but really, if there is a third option (a third plugin), I would love to hear about it.</p>
<p>Ok, so all that to lead up to a little plugin tutorial?  Well, it got your attention didn't it?</p>
<h1>Starting from scratch</h1>
<p>Ok, I guess I will start from scratch.  So let's get started.</p>
<h2>Creating a plugin</h2>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt><strong>5</strong><tt>
</tt>6<tt>
</tt>7<tt>
</tt>8<tt>
</tt>9<tt>
</tt><strong>10</strong><tt>
</tt>11<tt>
</tt>12<tt>
</tt>13<tt>
</tt>14<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }">pullmonkey<span class="er">$</span> ./script/generate plugin simple_blog<tt>
</tt>      create  vendor/plugins/simple_blog/lib<tt>
</tt>      create  vendor/plugins/simple_blog/tasks<tt>
</tt>      create  vendor/plugins/simple_blog/test<tt>
</tt>      create  vendor/plugins/simple_blog/<span class="co">README</span><tt>
</tt>      create  vendor/plugins/simple_blog/<span class="co">MIT</span>-<span class="co">LICENSE</span><tt>
</tt>      create  vendor/plugins/simple_blog/<span class="co">Rakefile</span><tt>
</tt>      create  vendor/plugins/simple_blog/init.rb<tt>
</tt>      create  vendor/plugins/simple_blog/install.rb<tt>
</tt>      create  vendor/plugins/simple_blog/uninstall.rb<tt>
</tt>      create  vendor/plugins/simple_blog/lib/simple_blog.rb<tt>
</tt>      create  vendor/plugins/simple_blog/tasks/simple_blog_tasks.rake<tt>
</tt>      create  vendor/plugins/simple_blog/test/simple_blog_test.rb<tt>
</tt>      create  vendor/plugins/simple_blog/test/test_helper.rb<tt>
</tt></pre>
</td>
</tr>
</table>
<h2>Create the app directories for your plugin</h2>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt><strong>5</strong><tt>
</tt>6<tt>
</tt>7<tt>
</tt>8<tt>
</tt>9<tt>
</tt><strong>10</strong><tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }">pullmonkey<span class="er">$</span> cd vendor/plugins/simple_blog/  <span class="c"># pretty important</span><tt>
</tt>pullmonkey<span class="er">$</span> ls<tt>
</tt>init.rb  install.rb  lib  <span class="co">MIT</span>-<span class="co">LICENSE</span>  <span class="co">Rakefile</span>  <span class="co">README</span>  tasks  test  uninstall.rb<tt>
</tt>pullmonkey<span class="er">$</span> mkdir app<tt>
</tt>pullmonkey<span class="er">$</span> mkdir -p app/models<tt>
</tt>pullmonkey<span class="er">$</span> mkdir -p app/controllers<tt>
</tt>pullmonkey<span class="er">$</span> mkdir -p app/views<tt>
</tt>pullmonkey<span class="er">$</span> mkdir -p app/helpers<tt>
</tt>pullmonkey<span class="er">$</span> ls app/<tt>
</tt>controllers  helpers  models  views<tt>
</tt></pre>
</td>
</tr>
</table>
<p>Well that was easy, so let's move on.</p>
<p></p>
<h1>Models, Views, Controllers and Helpers - Living as one in my plugin</h1>
<h2>Models</h2>
<p>Ok, so we have a clear path for where our models, controllers, views, and helpers should live, right?<br />
For simplicity, let's just have a post and comment model - you have all seen this a billion times.</p>
<h3>Models: vendor/plugins/simple_blog/app/models/post.rb</h3>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }"><span class="r">class</span> <span class="cl">Post</span> &lt; <span class="co">ActiveRecord</span>::<span class="co">Base</span><tt>
</tt>  has_many <span class="sy">:comments</span><tt>
</tt><span class="r">end</span></pre>
</td>
</tr>
</table>
<h3>Models: vendor/plugins/simple_blog/app/models/comment.rb</h3>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }"><span class="r">class</span> <span class="cl">Comment</span> &lt; <span class="co">ActiveRecord</span>::<span class="co">Base</span><tt>
</tt>  belongs_to <span class="sy">:post</span><tt>
</tt><span class="r">end</span></pre>
</td>
</tr>
</table>
<p>And there you have it.<br />
So what do you do to tell your rails application about your models?<br />
Simple - inside vendor/plugins/simple_blog/init.rb - add these lines</p>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }">model_path = <span class="co">File</span>.join(directory, <span class="s"><span class="dl">'</span><span class="k">app</span><span class="dl">'</span></span>, <span class="s"><span class="dl">'</span><span class="k">models</span><span class="dl">'</span></span>)<tt>
</tt><span class="gv">$LOAD_PATH</span> &lt;&lt; model_path<tt>
</tt><span class="co">ActiveSupport</span>::<span class="co">Dependencies</span>.load_paths &lt;&lt; model_path</pre>
</td>
</tr>
</table>
<h3>Ok, so let's test it out.</h3>
<p>Step 1 - we will need some default migrations for the model to use.<br />
Post migration:</p>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt><strong>5</strong><tt>
</tt>6<tt>
</tt>7<tt>
</tt>8<tt>
</tt>9<tt>
</tt><strong>10</strong><tt>
</tt>11<tt>
</tt>12<tt>
</tt>13<tt>
</tt>14<tt>
</tt><strong>15</strong><tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }">pullmonkey<span class="er">$</span> ./script/generate migration post<tt>
</tt><span class="c"># This is what mine looks like</span><tt>
</tt><span class="r">class</span> <span class="cl">Post</span> &lt; <span class="co">ActiveRecord</span>::<span class="co">Migration</span><tt>
</tt>  <span class="r">def</span> <span class="pc">self</span>.up<tt>
</tt>    create_table <span class="sy">:posts</span> <span class="r">do</span> |t|<tt>
</tt>      t.string <span class="sy">:subject</span><tt>
</tt>      t.text   <span class="sy">:body</span><tt>
</tt>      t.timestamps<tt>
</tt>    <span class="r">end</span><tt>
</tt>  <span class="r">end</span><tt>
</tt><tt>
</tt>  <span class="r">def</span> <span class="pc">self</span>.down<tt>
</tt>    drop_table <span class="sy">:posts</span><tt>
</tt>  <span class="r">end</span><tt>
</tt><span class="r">end</span></pre>
</td>
</tr>
</table>
<p>And then the comment migration:</p>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt><strong>5</strong><tt>
</tt>6<tt>
</tt>7<tt>
</tt>8<tt>
</tt>9<tt>
</tt><strong>10</strong><tt>
</tt>11<tt>
</tt>12<tt>
</tt>13<tt>
</tt>14<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }">pullmonkey<span class="er">$</span> ./script/generate migration comment<tt>
</tt><span class="c"># This is what mine looks like</span><tt>
</tt>  <span class="r">def</span> <span class="pc">self</span>.up<tt>
</tt>    create_table <span class="sy">:comments</span> <span class="r">do</span> |t|<tt>
</tt>      t.string <span class="sy">:username</span><tt>
</tt>      t.text   <span class="sy">:body</span><tt>
</tt>      t.references <span class="sy">:post</span><tt>
</tt>      t.timestamps<tt>
</tt>    <span class="r">end</span><tt>
</tt>  <span class="r">end</span><tt>
</tt><tt>
</tt>  <span class="r">def</span> <span class="pc">self</span>.down<tt>
</tt>    drop_table <span class="sy">:comments</span><tt>
</tt>  <span class="r">end</span></pre>
</td>
</tr>
</table>
<p>Run the migrations:</p>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre><tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }">pullmonkey<span class="er">$</span> rake db<span class="sy">:migrate</span></pre>
</td>
</tr>
</table>
<p>That was all just setup - now for the actual testing:</p>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt><strong>5</strong><tt>
</tt>6<tt>
</tt>7<tt>
</tt>8<tt>
</tt>9<tt>
</tt><strong>10</strong><tt>
</tt>11<tt>
</tt>12<tt>
</tt>13<tt>
</tt>14<tt>
</tt><strong>15</strong><tt>
</tt>16<tt>
</tt>17<tt>
</tt>18<tt>
</tt>19<tt>
</tt><strong>20</strong><tt>
</tt>21<tt>
</tt>22<tt>
</tt>23<tt>
</tt>24<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }">pullmonkey<span class="er">$</span> ./script/console<tt>
</tt><span class="co">Loading</span> development environment (<span class="co">Rails</span> <span class="fl">2.2</span>.<span class="i">2</span>)<tt>
</tt>&gt;&gt; <span class="co">Comment</span>.new<tt>
</tt>=&gt; <span class="c">#&lt;Comment id: nil, username: nil, body: nil, post_id: nil, created_at: nil, updated_at: nil&gt;</span><tt>
</tt>&gt;&gt; <span class="co">Post</span>.new<tt>
</tt>=&gt; <span class="c">#&lt;Post id: nil, subject: nil, body: nil, created_at: nil, updated_at: nil&gt;</span><tt>
</tt>&gt;&gt; p = <span class="co">Post</span>.create(<span class="sy">:subject</span> =&gt; <span class="s"><span class="dl">&quot;</span><span class="k">Test 1</span><span class="dl">&quot;</span></span>, <span class="sy">:body</span> =&gt; <span class="s"><span class="dl">&quot;</span><span class="k">My Body</span><span class="dl">&quot;</span></span>)<tt>
</tt>=&gt; <span class="c">#&lt;Post id: 1, subject: &quot;Test 1&quot;, body: &quot;My Body&quot;, created_at: &quot;2009-02-11 19:09:25&quot;, updated_at: &quot;2009-02-11 19:09:25&quot;&gt;</span><tt>
</tt>&gt;&gt; p.body<tt>
</tt>=&gt; <span class="s"><span class="dl">&quot;</span><span class="k">My Body</span><span class="dl">&quot;</span></span><tt>
</tt>&gt;&gt; p.subject<tt>
</tt>=&gt; <span class="s"><span class="dl">&quot;</span><span class="k">Test 1</span><span class="dl">&quot;</span></span><tt>
</tt>&gt;&gt; p.new_record?<tt>
</tt>=&gt; <span class="pc">false</span><tt>
</tt>&gt;&gt; p.comments<tt>
</tt>=&gt; []<tt>
</tt>&gt;&gt; c = <span class="co">Comment</span>.create(<span class="sy">:username</span> =&gt; <span class="s"><span class="dl">'</span><span class="k">pullmonkey</span><span class="dl">'</span></span>, <span class="sy">:body</span> =&gt; <span class="s"><span class="dl">&quot;</span><span class="k">this is simple</span><span class="dl">&quot;</span></span>)<tt>
</tt>=&gt; <span class="c">#&lt;Comment id: 1, username: &quot;pullmonkey&quot;, body: &quot;this is simple&quot;, post_id: nil, created_at: &quot;2009-02-11 19:10:01&quot;, updated_at: &quot;2009-02-11 19:10:01&quot;&gt;</span><tt>
</tt>&gt;&gt; p.comments &lt;&lt; c<tt>
</tt>=&gt; [<span class="c">#&lt;Comment id: 1, username: &quot;pullmonkey&quot;, body: &quot;this is simple&quot;, post_id: 1, created_at: &quot;2009-02-11 19:10:01&quot;, updated_at: &quot;2009-02-11 19:10:06&quot;&gt;]</span><tt>
</tt>&gt;&gt; p.comments<tt>
</tt>=&gt; [<span class="c">#&lt;Comment id: 1, username: &quot;pullmonkey&quot;, body: &quot;this is simple&quot;, post_id: 1, created_at: &quot;2009-02-11 19:10:01&quot;, updated_at: &quot;2009-02-11 19:10:06&quot;&gt;]</span><tt>
</tt>&gt;&gt; <span class="co">Post</span>.first.comments<tt>
</tt>=&gt; [<span class="c">#&lt;Comment id: 1, username: &quot;pullmonkey&quot;, body: &quot;this is simple&quot;, post_id: 1, created_at: &quot;2009-02-11 19:10:01&quot;, updated_at: &quot;2009-02-11 19:10:06&quot;&gt;]</span></pre>
</td>
</tr>
</table>
<p>That's probably good enough.  We have a working model and relationships.  The best part is that all the code is still in the plugin.<br />
What does my code space contain?</p>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt><strong>5</strong><tt>
</tt>6<tt>
</tt>7<tt>
</tt>8<tt>
</tt>9<tt>
</tt><strong>10</strong><tt>
</tt>11<tt>
</tt>12<tt>
</tt>13<tt>
</tt>14<tt>
</tt><strong>15</strong><tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }">pullmonkey<span class="er">$</span> ls -l app/**<tt>
</tt>app/controllers:<tt>
</tt>total <span class="i">4</span><tt>
</tt>-rw-rw-r--  <span class="i">1</span> pullmonkey pullmonkey <span class="i">720</span> <span class="co">Feb</span> <span class="i">11</span> <span class="i">11</span>:<span class="i">00</span> application.rb<tt>
</tt><tt>
</tt>app/helpers:<tt>
</tt>total <span class="i">4</span><tt>
</tt>-rw-rw-r--  <span class="i">1</span> pullmonkey pullmonkey <span class="i">115</span> <span class="co">Feb</span> <span class="i">11</span> <span class="i">11</span>:<span class="i">00</span> application_helper.rb<tt>
</tt><tt>
</tt>app/models:<tt>
</tt>total <span class="i">0</span><tt>
</tt><tt>
</tt>app/views:<tt>
</tt>total <span class="i">4</span><tt>
</tt>drwxrwxr-x  <span class="i">2</span> pullmonkey pullmonkey <span class="i">4096</span> <span class="co">Feb</span> <span class="i">11</span> <span class="i">11</span>:<span class="i">00</span> layouts</pre>
</td>
</tr>
</table>
<p>
Just the defaults - neat <img src="https://s.w.org/images/core/emoji/13.0.1/72x72/1f642.png" alt="🙂" class="wp-smiley" style="height: 1em; max-height: 1em;" /></p>
<h2>Controllers</h2>
<p>In much the same way as models, we can easily use controllers from our plugin.  No extracting, no engines plugin.</p>
<h3>Controllers: vendor/plugins/simple_blog/app/controllers/posts_controller.rb</h3>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt><strong>5</strong><tt>
</tt>6<tt>
</tt>7<tt>
</tt>8<tt>
</tt>9<tt>
</tt><strong>10</strong><tt>
</tt>11<tt>
</tt>12<tt>
</tt>13<tt>
</tt>14<tt>
</tt><strong>15</strong><tt>
</tt>16<tt>
</tt>17<tt>
</tt>18<tt>
</tt>19<tt>
</tt><strong>20</strong><tt>
</tt>21<tt>
</tt>22<tt>
</tt>23<tt>
</tt>24<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }"><span class="r">class</span> <span class="cl">PostsController</span> &lt; <span class="co">ApplicationController</span><tt>
</tt>  <span class="r">def</span> <span class="fu">index</span><tt>
</tt>    <span class="iv">@posts</span> = <span class="co">Post</span>.all<tt>
</tt>  <span class="r">end</span><tt>
</tt><tt>
</tt>  <span class="r">def</span> <span class="fu">show</span><tt>
</tt>    <span class="iv">@post</span> = <span class="co">Post</span>.find(params[<span class="sy">:id</span>])<tt>
</tt>  <span class="r">end</span><tt>
</tt><tt>
</tt>  <span class="r">def</span> <span class="fu">new</span><tt>
</tt>    <span class="iv">@post</span> = <span class="co">Post</span>.new<tt>
</tt>  <span class="r">end</span><tt>
</tt><tt>
</tt>  <span class="r">def</span> <span class="fu">create</span><tt>
</tt>    <span class="r">if</span> <span class="iv">@post</span> = <span class="co">Post</span>.create(params[<span class="sy">:post</span>])<tt>
</tt>      flash[<span class="sy">:notice</span>] = <span class="s"><span class="dl">&quot;</span><span class="k">Post Created</span><span class="dl">&quot;</span></span><tt>
</tt>      redirect_to <span class="sy">:action</span> =&gt; <span class="s"><span class="dl">'</span><span class="k">index</span><span class="dl">'</span></span><tt>
</tt>    <span class="r">else</span><tt>
</tt>      flash[<span class="sy">:error</span>] = <span class="s"><span class="dl">&quot;</span><span class="k">Post Not Created</span><span class="dl">&quot;</span></span><tt>
</tt>      render <span class="sy">:action</span> =&gt; <span class="s"><span class="dl">'</span><span class="k">new</span><span class="dl">'</span></span><tt>
</tt>    <span class="r">end</span><tt>
</tt>  <span class="r">end</span><tt>
</tt>  <span class="c">#.... more code</span><tt>
</tt><span class="r">end</span></pre>
</td>
</tr>
</table>
<h3>Controllers: vendor/plugins/simple_blog/app/controllers/comments_controller.rb</h3>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt><strong>5</strong><tt>
</tt>6<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }"><span class="r">class</span> <span class="cl">CommentsController</span> &lt; <span class="co">ApplicationController</span><tt>
</tt>  <span class="r">def</span> <span class="fu">index</span><tt>
</tt>    <span class="iv">@comments</span> = <span class="co">Comment</span>.find_all_by_post_id(params[<span class="sy">:post_id</span>])<tt>
</tt>  <span class="r">end</span><tt>
</tt>  <span class="c">#.... more code</span><tt>
</tt><span class="r">end</span></pre>
</td>
</tr>
</table>
<p>Now, to register the controllers, add the following to vendor/plugins/simple_blog/init.rb:</p>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }">controller_path = <span class="co">File</span>.join(directory, <span class="s"><span class="dl">'</span><span class="k">app</span><span class="dl">'</span></span>, <span class="s"><span class="dl">'</span><span class="k">controllers</span><span class="dl">'</span></span>)<tt>
</tt><span class="gv">$LOAD_PATH</span> &lt;&lt; controller_path<tt>
</tt><span class="co">ActiveSupport</span>::<span class="co">Dependencies</span>.load_paths &lt;&lt; controller_path<tt>
</tt>config.controller_paths &lt;&lt; controller_path</pre>
</td>
</tr>
</table>
<p>Ok, before we can really test this we will need to do the views, so keep going.</p>
<p></p>
<h2>Views</h2>
<p>Create your view directories:</p>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }">pullmonkey<span class="er">$</span> mkdir -p app/views/posts<tt>
</tt>pullmonkey<span class="er">$</span> mkdir -p app/views/comments</pre>
</td>
</tr>
</table>
<p>Create your views:<br />
For this example, I will just create one, then we will test it.</p>
<h3>Views: vendor/plugins/simple_blog/app/views/posts/index.html.erb</h3>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt><strong>5</strong><tt>
</tt>6<tt>
</tt>7<tt>
</tt>8<tt>
</tt>9<tt>
</tt><strong>10</strong><tt>
</tt>11<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }">&lt;h1&gt;<span class="co">Posts</span>&lt;<span class="rx"><span class="dl">/</span><span class="k">h1&gt;<tt>
</tt>&lt;% @posts.each do |post| -%&gt;<tt>
</tt>  &lt;h2&gt;&lt;%= h post.subject %&gt;&lt;</span><span class="dl">/</span></span>h2&gt;<tt>
</tt>  &lt;%= post.body <span class="s"><span class="dl">%&gt;</span><span class="k"><tt>
</tt>  &lt;h3</span><span class="dl">&gt;</span></span><span class="co">Comments</span>&lt;<span class="rx"><span class="dl">/</span><span class="k">h3&gt;<tt>
</tt>  &lt;% post.comments.each do |comment| -%&gt;<tt>
</tt>    &lt;b&gt;by &lt;%= comment.username %&gt;&lt;</span><span class="dl">/</span></span>b&gt;&lt;br/&gt;<tt>
</tt>    &lt;%= comment.body <span class="s"><span class="dl">%&gt;</span><span class="k">&lt;br/</span><span class="dl">&gt;</span></span><tt>
</tt>    &lt;br/&gt;<tt>
</tt>  &lt;% <span class="r">end</span> -<span class="s"><span class="dl">%&gt;</span><span class="k"><tt>
</tt>&lt;% end -%</span><span class="dl">&gt;</span></span></pre>
</td>
</tr>
</table>
<h3>Append your view paths:</h3>
<p>If you don't do this next step, you will very likely see an error message like this:<br />
Missing template posts/index.erb in view path /home/pullmonkey/rails_projects/simple_blog/app/views:</p>
<p>So let's add it. <br />
There are at least two ways to do this.  1) Added to your controllers individually or 2) Add to application controller globally.<br />
I prefer the less obtrusive, so let's go with number 1.<br />
For this test, we will just work with the posts controller, so open it up again and add this line:</p>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre><tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }"><span class="pc">self</span>.append_view_path(<span class="co">File</span>.join(<span class="co">File</span>.dirname(<span class="pc">__FILE__</span>), <span class="s"><span class="dl">'</span><span class="k">..</span><span class="dl">'</span></span>, <span class="s"><span class="dl">'</span><span class="k">views</span><span class="dl">'</span></span>))</pre>
</td>
</tr>
</table>
<p>So your file should look like this now:</p>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt><strong>5</strong><tt>
</tt>6<tt>
</tt>7<tt>
</tt>8<tt>
</tt>9<tt>
</tt><strong>10</strong><tt>
</tt>11<tt>
</tt>12<tt>
</tt>13<tt>
</tt>14<tt>
</tt><strong>15</strong><tt>
</tt>16<tt>
</tt>17<tt>
</tt>18<tt>
</tt>19<tt>
</tt><strong>20</strong><tt>
</tt>21<tt>
</tt>22<tt>
</tt>23<tt>
</tt>24<tt>
</tt><strong>25</strong><tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }"><span class="r">class</span> <span class="cl">PostsController</span> &lt; <span class="co">ApplicationController</span><tt>
</tt>  <span class="pc">self</span>.append_view_path(<span class="co">File</span>.join(<span class="co">File</span>.dirname(<span class="pc">__FILE__</span>), <span class="s"><span class="dl">'</span><span class="k">..</span><span class="dl">'</span></span>, <span class="s"><span class="dl">'</span><span class="k">views</span><span class="dl">'</span></span>))<tt>
</tt><tt>
</tt>  <span class="r">def</span> <span class="fu">index</span><tt>
</tt>    <span class="iv">@posts</span> = <span class="co">Post</span>.all<tt>
</tt>  <span class="r">end</span><tt>
</tt><tt>
</tt>  <span class="r">def</span> <span class="fu">show</span><tt>
</tt>    <span class="iv">@post</span> = <span class="co">Post</span>.find(params[<span class="sy">:id</span>])<tt>
</tt>  <span class="r">end</span><tt>
</tt><tt>
</tt>  <span class="r">def</span> <span class="fu">new</span><tt>
</tt>    <span class="iv">@post</span> = <span class="co">Post</span>.new<tt>
</tt>  <span class="r">end</span><tt>
</tt><tt>
</tt>  <span class="r">def</span> <span class="fu">create</span><tt>
</tt>    <span class="r">if</span> <span class="iv">@post</span> = <span class="co">Post</span>.create(params[<span class="sy">:post</span>])<tt>
</tt>      flash[<span class="sy">:notice</span>] = <span class="s"><span class="dl">&quot;</span><span class="k">Post Created</span><span class="dl">&quot;</span></span><tt>
</tt>      redirect_to <span class="sy">:action</span> =&gt; <span class="s"><span class="dl">'</span><span class="k">index</span><span class="dl">'</span></span><tt>
</tt>    <span class="r">else</span><tt>
</tt>      flash[<span class="sy">:error</span>] = <span class="s"><span class="dl">&quot;</span><span class="k">Post Not Created</span><span class="dl">&quot;</span></span><tt>
</tt>      render <span class="sy">:action</span> =&gt; <span class="s"><span class="dl">'</span><span class="k">new</span><span class="dl">'</span></span><tt>
</tt>    <span class="r">end</span><tt>
</tt>  <span class="r">end</span><tt>
</tt><span class="r">end</span></pre>
</td>
</tr>
</table>
<h3>Time to test</h3>
<p>Start your web server - ./script/server<br />
Browse to http://localhost:3000/posts<br />
You should see the post we created up above via Post.create(...) and its associated comment that we also created above.</p>
<p><b>Note:</b>Feel free to overwrite any of the views.  This can be done simply for the posts index view by creating the same file under RAILS_ROOT/app/views/posts/index.html.erb and doing what you'd like.</p>
<p></p>
<h1>That's it for part 1</h1>
<p>Ok, so that's part 1.  The goal was to keep everything external and I think we succeeded (aside from migrations).<br />
No offense to those that use engines or extract files into one's application's space, we all have our ways - the above is what I prefer.</p>
<p>
Part 2 will consist mainly of filling this out a bit more and further discussion on adding helpers, routes and migrations to your plugin without interfering in the application's code space.</p>
<p>As always, have fun and good luck!</p>
]]></content:encoded>
					
					<wfw:commentRss>http://pullmonkey.com/2009/02/11/blog-plugin-tutorial-for-ruby-on-rails/feed/</wfw:commentRss>
			<slash:comments>11</slash:comments>
		
		
			</item>
	</channel>
</rss>
