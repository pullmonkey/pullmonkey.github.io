<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>ruby on rails &#8211; PullMonkey Blog</title>
	<atom:link href="http://pullmonkey.com/tag/ruby-on-rails/feed/" rel="self" type="application/rss+xml" />
	<link>http://pullmonkey.com</link>
	<description></description>
	<lastBuildDate>Wed, 30 May 2012 15:35:39 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>https://wordpress.org/?v=5.6</generator>
	<item>
		<title>Rubygem version incompatability with older Rails versions</title>
		<link>http://pullmonkey.com/2012/05/30/rubygem-version-incompatability-with-older-rails-versions/</link>
		
		<dc:creator><![CDATA[charlie]]></dc:creator>
		<pubDate>Wed, 30 May 2012 15:35:39 +0000</pubDate>
				<category><![CDATA[development]]></category>
		<category><![CDATA[rails]]></category>
		<category><![CDATA[ruby]]></category>
		<category><![CDATA[incompatability]]></category>
		<category><![CDATA[ruby on rails]]></category>
		<category><![CDATA[rubygems]]></category>
		<guid isPermaLink="false">http://pullmonkey.com/?p=57701</guid>

					<description><![CDATA[We maintain a rails 2.3.8 application and haven't had to touch it in quite some time. But when we did, we came across this error: uninitialized constant ActiveSupport::Dependencies::Mutex (NameError) Then after applying the solution found here, we started getting this error: undefined method `name' for "actionmailer":String (NoMethodError) Both errors were resolved by using RVM to [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>We maintain a rails 2.3.8 application and haven't had to touch it in quite some time.  But when we did, we came across this error:</p>
<pre>uninitialized constant ActiveSupport::Dependencies::Mutex (NameError)</pre>
<p>Then after applying the solution found <a href="http://stackoverflow.com/questions/5176782/uninitialized-constant-activesupportdependenciesmutex-nameerror">here</a>, we started getting this error:</p>
<pre>undefined method `name' for "actionmailer":String (NoMethodError)</pre>
<p>Both errors were resolved by using RVM to specify the rubygem version best suited for this application.</p>
<pre>rvm rubygems 1.3.7</pre>
<p>So our .rvmrc file now looks like this:</p>
<pre>rvm use <ruby>@<gemset>
rvm rubygems 1.3.7</pre>
]]></content:encoded>
					
		
		
			</item>
		<item>
		<title>VIN API &#8211; ignore checksum validation</title>
		<link>http://pullmonkey.com/2011/10/28/vin-api-ignore-checksum-validation/</link>
		
		<dc:creator><![CDATA[charlie]]></dc:creator>
		<pubDate>Fri, 28 Oct 2011 15:55:35 +0000</pubDate>
				<category><![CDATA[Uncategorized]]></category>
		<category><![CDATA[project]]></category>
		<category><![CDATA[rails]]></category>
		<category><![CDATA[ruby]]></category>
		<category><![CDATA[ruby on rails]]></category>
		<category><![CDATA[simple]]></category>
		<category><![CDATA[skizmo]]></category>
		<category><![CDATA[software]]></category>
		<category><![CDATA[VIN]]></category>
		<category><![CDATA[vin api]]></category>
		<category><![CDATA[xml]]></category>
		<guid isPermaLink="false">http://pullmonkey.com/?p=57615</guid>

					<description><![CDATA[It's been mentioned a few times that there should be a way to skip the checksum validation. This means if the check digit calculation generally fails, VIN API will continue to process the VIN to see if there is a "like" VIN match. So here it is:]]></description>
										<content:encoded><![CDATA[<p>It's been mentioned a few times that there should be a way to skip the checksum validation.   This means if the <a href="http://en.wikipedia.org/wiki/Vehicle_Identification_Number#Check_digit_calculation">check digit calculation</a> generally fails, <a href="http://vinapi.skizmo.com">VIN API</a> will continue to process the VIN to see if there is a "like" VIN match.  So here it is: </p>
<p><script src="https://gist.github.com/1322591.js?file=gistfile1.rb"></script></p>
]]></content:encoded>
					
		
		
			</item>
		<item>
		<title>VIN API &#8211; fair pricing model</title>
		<link>http://pullmonkey.com/2011/01/24/vin-api-fair-pricing-model/</link>
					<comments>http://pullmonkey.com/2011/01/24/vin-api-fair-pricing-model/#comments</comments>
		
		<dc:creator><![CDATA[charlie]]></dc:creator>
		<pubDate>Mon, 24 Jan 2011 22:02:39 +0000</pubDate>
				<category><![CDATA[api]]></category>
		<category><![CDATA[biking]]></category>
		<category><![CDATA[development]]></category>
		<category><![CDATA[me]]></category>
		<category><![CDATA[Open Flash Chart Graphs]]></category>
		<category><![CDATA[projects]]></category>
		<category><![CDATA[rails]]></category>
		<category><![CDATA[ruby]]></category>
		<category><![CDATA[SimpleCMS]]></category>
		<category><![CDATA[tutorials]]></category>
		<category><![CDATA[project]]></category>
		<category><![CDATA[ruby on rails]]></category>
		<category><![CDATA[tutorial]]></category>
		<category><![CDATA[VIN]]></category>
		<category><![CDATA[vin api]]></category>
		<guid isPermaLink="false">http://pullmonkey.com/?p=57570</guid>

					<description><![CDATA[It can't be a shock to any of you that after many months (wait - more like a full year) of running VIN API completely free and out-of-pocket, it is time to monetize. As I am sure most of you know, the back-end data is quite pricey. For example, a monthly subscription for a "lite" [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>It can't be a shock to any of you that after many months (wait - more like <a href="http://pullmonkey.com/2010/02/19/vin-api-vin-decoder-for-anyone/">a full year</a>) of running <a href="http://vinapi.skizmo.com">VIN API</a> completely free and out-of-pocket, it is time to monetize.  As I am sure most of you know, the back-end data is quite pricey. For example, a monthly subscription for a "lite" data set (your typical year, make, model, engine type, etc) at one of the better known distributors would run you about $260.00 a month for ~800 VIN decodings.  This is some <strong>very</strong> expensive data at 32.5 cents a VIN.  Some of you that use our API are running 50,000+ VINs through in a weekend, that is $16,000!  Wow!  </p>
<p> Ok, so what did we decide to do?  Well first, and most importantly, we decided to keep the service up and running; for a while there it was looking pretty bleak and if you take a second to look at the numbers (financially) you can understand why.  Anyway, to be as fair as possible, we did not feel this could be monetized as a subscription-based product, some months you need 500,000 VINs and some only a 1,000.  Looking at the data for year, we had many questions - what plan would you pick?  should the plan rollover it's unused decodings?  </p>
<p> We discovered a lot of complexity in the subscription model, so we decided to setup the pay as you go plan, where you buy your decodings at various bulk levels.  For instance, you could buy in groups of 1,000 or 10,000 or 100,000 such that you would realize savings on a price-per-VIN basis the larger the group you purchase.  There is no use policy either, so you can sit on the VINs for as long as you want, or you can even buy decodings the day (even the minute) before you need them.  No monthly credit card bill, no rollovers, just simple "buy what you need," and if you buy in bulk, you save. </p>
<p>Another consideration in doing this was having to maintain soft limits. For example, if the user purchases the 5,000 VINs per month plan, and the their site does well this month and they need 6000 VINs, should they have chosen the 10,000 VIN plan?  We didn't think so, we figured no hard limit, just soft limits, and after the soft limit is hit, we would charge the additional VINs at the current rate per VIN to the user's next month's bill.  We tried to explain this to a few current users that are helping us come up with reasonable rates and they were not all that thrilled about it.  So we had a problem, we did not want users to pay for what they did not need, but at the same time we did not want to cut users off in the middle of a month when they hit their limit.  That entire idea had to be scrapped and along with it went the idea behind the subscription plan itself.  We like it though, it's simple now - buy your decodings and use your decodings, we will email you if you are getting low and may want to add decodings to your account.</p>
<p>Subscription models are great for static resources and static services, but not a single one of our customers decodes the same number of VINs each month, so it just won't work.  So onward and upward, pay as you go and regardless of how the other API providers offer their service, we are excited to be a little different and lot cheaper as you will soon find out.</p>
<p>Enjoy!</p>
]]></content:encoded>
					
					<wfw:commentRss>http://pullmonkey.com/2011/01/24/vin-api-fair-pricing-model/feed/</wfw:commentRss>
			<slash:comments>6</slash:comments>
		
		
			</item>
		<item>
		<title>Open Flash Chart II and Rails 3</title>
		<link>http://pullmonkey.com/2010/09/07/open-flash-chart-ii-and-rails-3/</link>
					<comments>http://pullmonkey.com/2010/09/07/open-flash-chart-ii-and-rails-3/#comments</comments>
		
		<dc:creator><![CDATA[charlie]]></dc:creator>
		<pubDate>Tue, 07 Sep 2010 17:06:49 +0000</pubDate>
				<category><![CDATA[development]]></category>
		<category><![CDATA[Open Flash Chart Graphs]]></category>
		<category><![CDATA[projects]]></category>
		<category><![CDATA[rails]]></category>
		<category><![CDATA[ruby]]></category>
		<category><![CDATA[tutorials]]></category>
		<category><![CDATA[open flash chart]]></category>
		<category><![CDATA[plugin]]></category>
		<category><![CDATA[project]]></category>
		<category><![CDATA[ruby on rails]]></category>
		<category><![CDATA[tutorial]]></category>
		<guid isPermaLink="false">http://pullmonkey.com/?p=57537</guid>

					<description><![CDATA[Just a quick note about the Open Flash Chart II plugin for Rails and Rails 3.  Rails 3 did a 180 with regards to ERB tags and security.  Everything is now considered unsafe HTML.  So where we used to be able to do &#60;%= @graph %&#62;, we have to now do &#60;%= @graph.html_safe %&#62;. Thanks [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>Just a quick note about the Open Flash Chart II plugin for Rails and Rails 3.  Rails 3 did a 180 with regards to ERB tags and security.  Everything is now considered unsafe HTML.  So where we used to be able to do &lt;%= @graph %&gt;, we have to now do &lt;%= @graph.html_safe %&gt;.</p>
<p>Thanks go to <a href="http://github.com/pullmonkey/open_flash_chart/issues#issue/12">kendagriff</a>.</p>
]]></content:encoded>
					
					<wfw:commentRss>http://pullmonkey.com/2010/09/07/open-flash-chart-ii-and-rails-3/feed/</wfw:commentRss>
			<slash:comments>1</slash:comments>
		
		
			</item>
		<item>
		<title>POST OFC Graph as Image</title>
		<link>http://pullmonkey.com/2010/01/06/post_ofc_graph_as_image/</link>
					<comments>http://pullmonkey.com/2010/01/06/post_ofc_graph_as_image/#comments</comments>
		
		<dc:creator><![CDATA[charlie]]></dc:creator>
		<pubDate>Wed, 06 Jan 2010 21:17:57 +0000</pubDate>
				<category><![CDATA[development]]></category>
		<category><![CDATA[Javascript]]></category>
		<category><![CDATA[me]]></category>
		<category><![CDATA[Open Flash Chart Graphs]]></category>
		<category><![CDATA[plugins]]></category>
		<category><![CDATA[projects]]></category>
		<category><![CDATA[rails]]></category>
		<category><![CDATA[ruby]]></category>
		<category><![CDATA[SimpleCMS]]></category>
		<category><![CDATA[tutorials]]></category>
		<category><![CDATA[charts]]></category>
		<category><![CDATA[graphs]]></category>
		<category><![CDATA[image]]></category>
		<category><![CDATA[open flash chart]]></category>
		<category><![CDATA[png]]></category>
		<category><![CDATA[ruby on rails]]></category>
		<guid isPermaLink="false">http://pullmonkey.com/?p=57469</guid>

					<description><![CDATA[I was asked recently (well sort of) to give an example of saving an image to the server. If you look at teethgrinder's example for this, you will see that he has made available an external interface to do just that - POST your graph as png raw data to your server for storage. This [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>I was <a href="http://github.com/inbox/365812#reply">asked recently (well sort of) to give an example of saving an image to the server</a>.  If you look at <a href="http://teethgrinder.co.uk/open-flash-chart-2/adv-upload-image.php">teethgrinder's example for this</a>, you will see that he has made available an external interface to do just that - POST your graph as png raw data to your server for storage.  This has many benefits such as saving the image for use in a PDF report or for printing, since we know at times it is a bit troublesome to print the embedded flash object.<br />
I think the main problem people are having with this is the receiving of the image data post - see the upload_image method below.  Also, teethgrinder's example never really says where to make the post_image() call.  So I touch on both in the code below.<br />
Here is an example of the png that is saved when I did this for the chart in the previous example:<br />
<img loading="lazy" src="http://pullmonkey.com/wp-content/uploads/2010/01/tmp_image.png" alt="OFC Saved Image" title="OFC Saved Image" width="550" height="300" class="aligncenter size-full wp-image-57468" srcset="http://pullmonkey.com/wp-content/uploads/2010/01/tmp_image.png 550w, http://pullmonkey.com/wp-content/uploads/2010/01/tmp_image-300x163.png 300w" sizes="(max-width: 550px) 100vw, 550px" /></p>
<p>Well, let's just get right in to the code.<br />
The controller contains the same code as <a href="http://pullmonkey.com/2010/01/05/open-flash-chart-ii-x-axis-date-and-time/">my last post</a> with only a few minor changes to the index method and the addition of the upload_image method.<br />
In the <b>controller</b>, I have this:</p>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt>5<tt>
</tt>6<tt>
</tt>7<tt>
</tt>8<tt>
</tt>9<tt>
</tt><strong>10</strong><tt>
</tt>11<tt>
</tt>12<tt>
</tt>13<tt>
</tt>14<tt>
</tt>15<tt>
</tt>16<tt>
</tt>17<tt>
</tt>18<tt>
</tt>19<tt>
</tt><strong>20</strong><tt>
</tt>21<tt>
</tt>22<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }"><span style="color:#080;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">TestItController</span> &lt; <span style="color:#036;font-weight:bold">ApplicationController</span><tt>
</tt>  <span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">index</span><tt>
</tt>    <span style="color:#888"># note the user of open_flash_chart_object_from_hash instead of just open_flash_chart_object</span><tt>
</tt>    <span style="color:#888"># this allows you to pass in the id of the div you want the the chart to be in</span><tt>
</tt>    <span style="color:#888"># this is useful for when we need to findSWF by this id</span><tt>
</tt>    <span style="color:#33B">@graph</span> = open_flash_chart_object_from_hash(<span style="background-color:#fff0f0;color:#D20"><span style="color:#710">&quot;</span><span style="">/test_it/chart</span><span style="color:#710">&quot;</span></span>, <span style="color:#A60">:div_name</span> =&gt; <span style="background-color:#fff0f0;color:#D20"><span style="color:#710">&quot;</span><span style="">my_chart</span><span style="color:#710">&quot;</span></span>)<tt>
</tt>  <span style="color:#080;font-weight:bold">end</span><tt>
</tt><tt>
</tt>  <span style="color:#888"># added to recieve the post data for the OFC png image of the OFC graph</span><tt>
</tt>  <span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">upload_image</span><tt>
</tt>    name = <span style="background-color:#fff0f0;color:#D20"><span style="color:#710">&quot;</span><span style="">tmp_image.png</span><span style="color:#710">&quot;</span></span> || params[<span style="color:#A60">:name</span>]<tt>
</tt>    <span style="color:#888"># the save_image method that is provided by the OFC swf file sends raw post data, so get to it like this</span><tt>
</tt>    data = request.raw_post<tt>
</tt>    <span style="color:#036;font-weight:bold">File</span>.open(<span style="background-color:#fff0f0;color:#D20"><span style="color:#710">&quot;</span><span style="background:#ddd;color:black"><span style="background:#ddd;font-weight:bold;color:#666">#{</span><span style="color:#036;font-weight:bold">RAILS_ROOT</span><span style="background:#ddd;font-weight:bold;color:#666">}</span></span><span style="">/tmp/</span><span style="background:#ddd;color:black"><span style="background:#ddd;font-weight:bold;color:#666">#{</span>name<span style="background:#ddd;font-weight:bold;color:#666">}</span></span><span style="color:#710">&quot;</span></span>, <span style="background-color:#fff0f0;color:#D20"><span style="color:#710">&quot;</span><span style="">wb</span><span style="color:#710">&quot;</span></span>) { |f| f.write(data) } <span style="color:#080;font-weight:bold">if</span> data<tt>
</tt>    render <span style="color:#A60">:nothing</span> =&gt; <span style="color:#038;font-weight:bold">true</span><tt>
</tt>  <span style="color:#080;font-weight:bold">end</span><tt>
</tt><tt>
</tt>  <span style="color:#080;font-weight:bold">def</span> <span style="color:#06B;font-weight:bold">chart</span><tt>
</tt>    <span style="color:#888"># same code from here - http://pullmonkey.com/2010/01/05/open-flash-chart-ii-x-axis-date-and-time/ </span><tt>
</tt>    ...<tt>
</tt>  <span style="color:#080;font-weight:bold">end</span><tt>
</tt><span style="color:#080;font-weight:bold">end</span></pre>
</td>
</tr>
</table>
<p>So just <b>note</b> the use of open_flash_chart_object_from_hash() in the index method, this way we can pass in the id of the div.<br />
In the <b>view</b>, I have this:</p>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt>5<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }">&lt;<span style="background-color:#fff0f0;color:#D20"><span style="color:#710">%=</span><span style=""> javascript_include_tag 'swfobject.js' %&gt;<tt>
</tt>&lt;%</span><span style="color:#710">=</span></span> <span style="color:#33B">@graph</span> %&gt;<tt>
</tt>&lt;<span style="background-color:#fff0f0;color:#D20"><span style="color:#710">%=</span><span style=""> save_as_image(&quot;http://localhost:3000/test_it/upload_image?name</span><span style="color:#710">=</span></span>tmp.png<span style="background-color:#fff0f0;color:#D20"><span style="color:#710">&quot;</span><span style="">, :id =&gt; </span><span style="color:#710">&quot;</span></span>my_chart<span style="background-color:#fff0f0;color:#D20"><span style="color:#710">&quot;</span><span style="">) %&gt;<tt>
</tt>&lt;br/&gt;<tt>
</tt>&lt;%= button_to_function </span><span style="color:#710">&quot;</span></span><span style="color:#036;font-weight:bold">Save</span> <span style="color:#036;font-weight:bold">Image</span><span style="background-color:#fff0f0;color:#D20"><span style="color:#710">&quot;</span><span style="">, </span><span style="color:#710">&quot;</span></span>post_image()<span style="background-color:#fff0f0;color:#D20"><span style="color:#710">&quot;</span><span style=""> %&gt;</span></span></pre>
</td>
</tr>
</table>
<p>
Really the only difference from what we would normally have in our view is that I am using the save image setup method that was added to the <a href="http://github.com/pullmonkey/open_flash_chart/commit/14ff9735c67e9b424caa129e8e06dc910e73681f">open flash chart ruby on rails plugin</a> in the last couple hours (as of this post).  The save_image method takes some arguments, mainly the url to post the image data to and the id of the chart we setup in the controller.</p>
]]></content:encoded>
					
					<wfw:commentRss>http://pullmonkey.com/2010/01/06/post_ofc_graph_as_image/feed/</wfw:commentRss>
			<slash:comments>2</slash:comments>
		
		
			</item>
		<item>
		<title>THINning it out</title>
		<link>http://pullmonkey.com/2009/09/14/thinning-it-out/</link>
					<comments>http://pullmonkey.com/2009/09/14/thinning-it-out/#comments</comments>
		
		<dc:creator><![CDATA[charlie]]></dc:creator>
		<pubDate>Mon, 14 Sep 2009 21:02:13 +0000</pubDate>
				<category><![CDATA[development]]></category>
		<category><![CDATA[rails]]></category>
		<category><![CDATA[ruby]]></category>
		<category><![CDATA[tutorials]]></category>
		<category><![CDATA[capistrano]]></category>
		<category><![CDATA[mongrel]]></category>
		<category><![CDATA[ruby on rails]]></category>
		<category><![CDATA[thin]]></category>
		<guid isPermaLink="false">http://pullmonkey.com/?p=57393</guid>

					<description><![CDATA[Been having problems with swap space and memory on my slicehost servers.  And it is all apache's and mongrel's fault.  That used to be the cool combination and now it is an ugly, sluggish beast.  Just recently, I switched to nginx (to replace apache) and thin (to replace mongrel).  So far so good, major speed [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>Been having problems with swap space and memory on my slicehost servers.  And it is all apache's and mongrel's fault.  That used to be the cool combination and now it is an ugly, sluggish beast.  Just recently, I switched to nginx (to replace apache) and thin (to replace mongrel).  So far so good, major speed improvements and definitely memory consumption improvements.</p>
<p>I started out by switching everything over the nginx while keeping the mongrels alive, that was actually pretty easy.  Information was available everywhere.</p>
<p>Thinning everything via capistrano took a while, that wasn't as well documented.  Thin was documented, capistrano was documented, but easy solutions as to how to combine the two were difficult to find.</p>
<p>Here's the solution I was able to come up with -</p>
<h2>Capistrano</h2>
<p>My config for using mongrel used to look something like this -</p>
<p>[code lang="ruby"]<br />
set :stages, %w(staging production)<br />
set :default_stage, "production"</p>
<p>require "capistrano/ext/multistage"<br />
require "mongrel_cluster/recipes"</p>
<p>set :application, "myapplication.com"<br />
set :user, "appuser"set :repository,  "http://svn.myapplication.com/myapp/trunk"<br />
set :deploy_to, "/var/www/#{application}"</p>
<p>role :app, application<br />
role :web, application<br />
role :db,  application, :primary => true</p>
<p>set :runner, user<br />
set :keep_releases, 3<br />
set(:mongrel_conf) { "#{current_path}/config/mongrel_cluster.yml" }</p>
<p>deploy.task :after_update_code, :roles => [:web] do<br />
desc "Copying the right mongrel cluster config for the current stage environment."<br />
run "cp -f #{release_path}/config/mongrel_#{stage}.yml #{release_path}/config/mongrel_cluster.yml"<br />
end</p>
<p>... <other things like symlinks><br />
[/code]</p>
<p>Now that we are moving from mongrel to thin, no need for two lines in particular, one being the line that requires mongrel_cluster recipes and the other that sets the mongrel_cluster yaml config path.  A third line changes from mongrel_cluster.yml to thin_cluster.yml.  You get something like this:</p>
<p>[code lang="ruby"]<br />
set :stages, %w(staging production)<br />
set :default_stage, "production"</p>
<p>require "capistrano/ext/multistage"</p>
<p>set :application, "myapplication.com"<br />
set :user, "appuser"</p>
<p>set :repository,  "http://svn.myapplication.com/myapp/trunk"<br />
set :deploy_to, "/var/www/#{application}"</p>
<p>role :app, application<br />
role :web, application<br />
role :db,  application, :primary => true</p>
<p>set :runner, user<br />
set :keep_releases, 3</p>
<p>deploy.task :after_update_code, :roles => [:web] do<br />
desc "Copying the right mongrel cluster config for the current stage environment."<br />
run "cp -f #{release_path}/config/thin_#{stage}.yml #{release_path}/config/thin_cluster.yml"<br />
end<br />
... <other things like symlinks><br />
[/code]</p>
<p>Now we need to implement what mongrel recipes was doing for us, start, stop and restart but in terms of thin (added this to the bottom of my deploy.rb):</p>
<p>[code lang="ruby"]<br />
namespace :deploy do<br />
desc "Restart the Thin processes on the app server."<br />
task :restart do<br />
run "thin restart -C #{release_path}/config/thin_cluster.yml"<br />
end<br />
desc "Start the Thin processes on the app server."<br />
task :start do<br />
run "thin start -C #{release_path}/config/thin_cluster.yml"<br />
end<br />
desc "Stop the Thin processes on the app server."<br />
task :stop do<br />
run "thin stop -C #{release_path}/config/thin_cluster.yml"<br />
end<br />
end<br />
[/code]</p>
<p>Here's what my thin_cluster.yml looks like:</p>
<p>[code lang="ruby"]</p>
<p>---<br />
log: log/thin.log<br />
address: 127.0.0.1<br />
port: 9000<br />
chdir: /var/www/myapp.com/current<br />
environment: production<br />
pid: tmp/pids/thin.pid<br />
user: www-user<br />
group: www-data<br />
servers: 3<br />
[/code]</p>
<p>That's it and it has worked out nicely so far.</p>
]]></content:encoded>
					
					<wfw:commentRss>http://pullmonkey.com/2009/09/14/thinning-it-out/feed/</wfw:commentRss>
			<slash:comments>1</slash:comments>
		
		
			</item>
		<item>
		<title>Open Flash Chart II &#8211; fully automated</title>
		<link>http://pullmonkey.com/2009/04/30/open-flash-chart-ii-fully-automated/</link>
					<comments>http://pullmonkey.com/2009/04/30/open-flash-chart-ii-fully-automated/#comments</comments>
		
		<dc:creator><![CDATA[charlie]]></dc:creator>
		<pubDate>Thu, 30 Apr 2009 16:33:00 +0000</pubDate>
				<category><![CDATA[development]]></category>
		<category><![CDATA[Home]]></category>
		<category><![CDATA[Open Flash Chart Graphs]]></category>
		<category><![CDATA[projects]]></category>
		<category><![CDATA[rails]]></category>
		<category><![CDATA[ruby]]></category>
		<category><![CDATA[tutorials]]></category>
		<category><![CDATA[charts]]></category>
		<category><![CDATA[flash]]></category>
		<category><![CDATA[graphs]]></category>
		<category><![CDATA[open flash chart]]></category>
		<category><![CDATA[ruby on rails]]></category>
		<guid isPermaLink="false">/2009/04/30/open-flash-chart-ii-fully-automated</guid>

					<description><![CDATA[Just as an attention grabber - we are going after this example in this article: Keeping up Ok, seeing that the php versions of open flash chart and open flash chart swf files continually change along with with the API (not saying this is a bad thing), I wanted to come up with an even [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>Just as an attention grabber - we are going after this example in this article:<br />
<script type="text/javascript" src="/projects/javascripts/swfobject.js"></script></p>
<div id="flash_content_blog_01"></div>
<p><script type="text/javascript">
  swfobject.embedSWF("/projects/open-flash-chart-ichor.swf", "flash_content_blog_01", "600", "300", "9.0.0", "expressInstall.swf",{"data-file":"/projects/open_flash_chart22/area_hollow"}, {"wmode":"transparent"});
</script></p>
<h2>Keeping up</h2>
<p>Ok, seeing that the <a href="http://teethgrinder.co.uk/open-flash-chart-2/">php versions of open flash chart</a> and open flash chart swf files continually change along with with the API (not saying this is a bad thing), I wanted to come up with an even more abstract solution.   The goal is to not have to worry when the swf file is released with the latest set of graphs or changes its API.  I simply don't want to worry about this method or that method, or this class or that class. </p>
<h2>Feedback</h2>
<p>This article will sort of act as a tutorial for those interested in metaprogramming and as a set of instructions for those looking to experiment with the <a href="http://github.com/pullmonkey/open_flash_chart/tree/test">latest version of the OFC II Rails Plugin that I am currently toying with</a>.  I would like to hear feedback, but just remember that phase 1 of this release will be very basic, meaning none of the ajaxy stuff.  It will come, just not yet.</p>
<h2>Let's see what we can get away with</h2>
<p>I am already using method_missing() for pretty much everything in the <a href="http://github.com/pullmonkey/open_flash_chart/tree/master">OFC II Rails Plugin that is being used now</a>.  But every time new classes are added, I have to sit down and basically convert the php class to ruby - just plain tedious, not really what I had planned when I started all this.  Ok, so method_missing() was great, but let me introduce (or possibly reintroduce) you to const_missing(), basically method_missing() but instead of methods, we can create classes or modules or other objects on the fly.  This will definitely help when the php version gets a new class.  Instead of getting hounded to update the rails version to be 100% like the php version, everything will just work, no updates to code required.  Well, we hope !   So check this out:</p>
<p>Here is what we did with method_missing():</p>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt><strong>5</strong><tt>
</tt>6<tt>
</tt>7<tt>
</tt>8<tt>
</tt>9<tt>
</tt><strong>10</strong><tt>
</tt>11<tt>
</tt>12<tt>
</tt>13<tt>
</tt>14<tt>
</tt><strong>15</strong><tt>
</tt>16<tt>
</tt>17<tt>
</tt>18<tt>
</tt>19<tt>
</tt><strong>20</strong><tt>
</tt>21<tt>
</tt>22<tt>
</tt>23<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }"><tt>
</tt><span class="r">module</span> <span class="cl">OFC</span><tt>
</tt>  <span class="r">class</span> <span class="cl">Base</span><tt>
</tt>    <span class="r">def</span> <span class="fu">method_missing</span>(method_name, *args, &amp;blk)<tt>
</tt>      <span class="r">case</span> method_name.to_s<tt>
</tt>      <span class="r">when</span> <span class="rx"><span class="dl">/</span><span class="k">(.*)=</span><span class="dl">/</span></span>   <span class="c"># i.e., if it is something x_legend=</span><tt>
</tt>        <span class="c"># if the user wants to set an instance variable then let them</span><tt>
</tt>        <span class="c"># the other args (args[0]) are ignored since it is a set method</span><tt>
</tt>        <span class="pc">self</span>.instance_variable_set(<span class="s"><span class="dl">&quot;</span><span class="k">@</span><span class="il"><span class="dl">#{</span><span class="gv">$1</span><span class="dl">}</span></span><span class="dl">&quot;</span></span>, args[<span class="i">0</span>])<tt>
</tt>      <span class="r">when</span> <span class="rx"><span class="dl">/</span><span class="k">^set_(.*)</span><span class="dl">/</span></span><tt>
</tt>        <span class="c"># backwards compatible ... the user can still use the same set_y_legend methods if they want</span><tt>
</tt>        <span class="pc">self</span>.instance_variable_set(<span class="s"><span class="dl">&quot;</span><span class="k">@</span><span class="il"><span class="dl">#{</span><span class="gv">$1</span><span class="dl">}</span></span><span class="dl">&quot;</span></span>, args[<span class="i">0</span>])<tt>
</tt>      <span class="r">else</span><tt>
</tt>          <span class="r">if</span> inst = <span class="pc">self</span>.instance_variable_get(<span class="s"><span class="dl">&quot;</span><span class="k">@</span><span class="il"><span class="dl">#{</span>method_name<span class="dl">}</span></span><span class="dl">&quot;</span></span>)<tt>
</tt>            inst<tt>
</tt>          <span class="r">else</span><tt>
</tt>            <span class="c"># if the method/attribute is missing and it is not a set method then hmmmm better let the user know</span><tt>
</tt>            <span class="r">super</span><tt>
</tt>          <span class="r">end</span><tt>
</tt>      <span class="r">end</span><tt>
</tt>    <span class="r">end</span><tt>
</tt>  <span class="r">end</span><tt>
</tt><span class="r">end</span><tt>
</tt></pre>
</td>
</tr>
</table>
<p>This just basically allows me to do this:</p>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt><strong>5</strong><tt>
</tt>6<tt>
</tt>7<tt>
</tt>8<tt>
</tt>9<tt>
</tt><strong>10</strong><tt>
</tt>11<tt>
</tt>12<tt>
</tt>13<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }"><tt>
</tt>  <span class="r">class</span> <span class="cl">Foo</span> &lt; <span class="co">OFC</span>::<span class="co">Base</span><tt>
</tt>  <span class="r">end</span><tt>
</tt><tt>
</tt>  foo = <span class="co">Foo</span>.new<tt>
</tt><tt>
</tt>  foo.some_random_attribute = <span class="s"><span class="dl">&quot;</span><span class="k">Hello</span><span class="dl">&quot;</span></span>  <span class="c">#=&gt; &quot;Hello&quot;</span><tt>
</tt>  foo.some_random_attribute  <span class="c">#=&gt; &quot;Hello&quot;</span><tt>
</tt>  foo.some_random_undefined_attribute  <span class="c">#=&gt; Method Missing error (calls super)</span><tt>
</tt><tt>
</tt>  <span class="c"># too be like php, for easier conversion</span><tt>
</tt>  foo.set_some_random_attribute(<span class="s"><span class="dl">&quot;</span><span class="k">Good Bye</span><span class="dl">&quot;</span></span>)  <span class="c">#=&gt; &quot;Good Bye&quot;</span><tt>
</tt>  foo.some_random_attribute  <span class="c">#=&gt; &quot;Good Bye&quot;</span><tt>
</tt></pre>
</td>
</tr>
</table>
<p>Along the same lines, I have created an initialize method that takes any argument hash of variable/value pairs and calls variable=() which is handled by method missing as we saw above:</p>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt><strong>5</strong><tt>
</tt>6<tt>
</tt>7<tt>
</tt>8<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }"><tt>
</tt>  <span class="r">class</span> <span class="cl">Foo</span> &lt; <span class="co">OFC</span>::<span class="co">Base</span><tt>
</tt>  <span class="r">end</span><tt>
</tt><tt>
</tt>  foo = <span class="co">Foo</span>.new(<span class="sy">:x_axis</span> =&gt; <span class="i">5</span>, <span class="sy">:min</span> =&gt; <span class="i">10</span>, <span class="sy">:max</span> =&gt; <span class="i">90</span>, <span class="sy">:steps</span> =&gt; <span class="i">5</span>, <span class="sy">:elements</span> =&gt; [<span class="s"><span class="dl">&quot;</span><span class="k">one</span><span class="dl">&quot;</span></span>, <span class="s"><span class="dl">&quot;</span><span class="k">two</span><span class="dl">&quot;</span></span>])<tt>
</tt>  <tt>
</tt>  foo.x_axis <span class="c">#=&gt; 5</span><tt>
</tt>  foo.min <span class="c">#=&gt; 10</span><tt>
</tt></pre>
</td>
</tr>
</table>
<p>Ok, so on to const_missing() and what we can do with that:</p>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt><strong>5</strong><tt>
</tt>6<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }"><tt>
</tt>  <span class="r">def</span> <span class="co">OFC</span>.const_missing(const)<tt>
</tt>    klass = <span class="co">Class</span>.new <span class="co">OFC</span>::<span class="co">Base</span><tt>
</tt>    <span class="co">Object</span>.const_set const, klass<tt>
</tt>    <span class="r">return</span> klass<tt>
</tt>  <span class="r">end</span><tt>
</tt></pre>
</td>
</tr>
</table>
<p>This says that any undefined (missing) constant of OFC should be defined as a new class that inherits from OFC::Base.</p>
<p>So when we say OFC::Foo, that has not been defined, so we will get back class OFC::Foo < OFC::Base;end; which will give us the initialize() method and method_missing() method from above.  Let's see how this works:</p>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt><strong>5</strong><tt>
</tt>6<tt>
</tt>7<tt>
</tt>8<tt>
</tt>9<tt>
</tt><strong>10</strong><tt>
</tt>11<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }"><tt>
</tt>  line = <span class="co">OFC</span>::<span class="co">Line</span>.new(<span class="sy">:values</span> =&gt; [<span class="i">1</span>,<span class="i">2</span>,<span class="i">3</span>,<span class="pc">nil</span>,<span class="pc">nil</span>,<span class="i">5</span>,<span class="i">6</span>,<span class="i">7</span>])<tt>
</tt>  line.values <span class="c">#=&gt; [1,2,3,nil,nil,5,6,7]</span><tt>
</tt>  line.some_random_variable = <span class="s"><span class="dl">&quot;</span><span class="k">Hello</span><span class="dl">&quot;</span></span> <span class="c">#=&gt; &quot;Hello&quot;</span><tt>
</tt>  line.some_random_variable <span class="c">#=&gt; &quot;Hello&quot;</span><tt>
</tt><tt>
</tt>  stacked_bar_chart = <span class="co">OFC</span>::<span class="co">BarStack</span>.new<tt>
</tt>  stacked_bar_chart.values = []<tt>
</tt>  stacked_bar_chart.values &lt;&lt; [<span class="i">2</span>,<span class="i">3</span>,<span class="i">4</span>]<tt>
</tt>  stacked_bar_chart.values &lt;&lt; [<span class="i">5</span>, {<span class="s"><span class="dl">&quot;</span><span class="k">val</span><span class="dl">&quot;</span></span> =&gt; <span class="i">5</span>, <span class="s"><span class="dl">&quot;</span><span class="k">colour</span><span class="dl">&quot;</span></span> =&gt; <span class="s"><span class="dl">&quot;</span><span class="k">#ff0000</span><span class="dl">&quot;</span></span>}]<tt>
</tt>  stacked_bar_chart.keys = [{ <span class="s"><span class="dl">&quot;</span><span class="k">colour</span><span class="dl">&quot;</span></span> =&gt; <span class="s"><span class="dl">&quot;</span><span class="k">#C4D318</span><span class="dl">&quot;</span></span>, <span class="s"><span class="dl">&quot;</span><span class="k">text</span><span class="dl">&quot;</span></span> =&gt; <span class="s"><span class="dl">&quot;</span><span class="k">Kiting</span><span class="dl">&quot;</span></span>, <span class="s"><span class="dl">&quot;</span><span class="k">font-size</span><span class="dl">&quot;</span></span> =&gt; <span class="i">13</span> } ...]<tt>
</tt></pre>
</td>
</tr>
</table>
<p>So it all sort of came together right there.  I've shown you all the code that comes with the Rails Open Flash Chart plugin now.   No more definining idividual classes, no more trying to keep up with the never ending php version, and no more late nights converting php to ruby (!).  About dang time.</p>
<p>Ok, but this is just the beginning, nothing has been set in stone, so like I said, give me your feedback, what works for you and what does not.  And, hopefully, I will have solutions for you or you for me.</p>
<p></p>
<h2>Example with new version (test version)</h2>
<p>I am using rails 2.3.2, but I don't think it will matter what version you are using.</p>
<h3>Create your new rails project</h3>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt><strong>5</strong><tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }"><tt>
</tt><span class="c"># create a new rails project </span><tt>
</tt>&gt; pullmonkey<span class="er">$</span> rails testing_it<tt>
</tt><span class="c">#&lt;Bunch of stuff is created ....&gt;</span><tt>
</tt>&gt; pullmonkey<span class="er">$</span> cd testing_it/<tt>
</tt></pre>
</td>
</tr>
</table>
<h3>Install the plugin from the test branch</h3>
<p>Note the -r test in this next step.  The new version (test version) I am playing with is under the test branch and -r says what branch to pull from.</p>
<p>Also, you can use git:// instead of http:// below, but depending on your firewall restrictions http:// will probably work out best for you.</p>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }"><tt>
</tt>&gt; pullmonkey<span class="er">$</span> ./script/plugin install http<span class="sy">:/</span>/github.com/pullmonkey/open_flash_chart.git -r test<tt>
</tt><span class="c"># &lt;Bunch more stuff ...&gt;</span><tt>
</tt></pre>
</td>
</tr>
</table>
<h3>Create a controller to play in</h3>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }"><tt>
</tt>&gt; pullmonkey<span class="er">$</span> ./script/generate controller test_it<tt>
</tt><span class="c"># &lt;And more stuff &gt;</span><tt>
</tt></pre>
</td>
</tr>
</table>
<h3>Get our assets</h3>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt><strong>5</strong><tt>
</tt>6<tt>
</tt>7<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }"><tt>
</tt><span class="c"># first we will get swfobject.js</span><tt>
</tt>&gt; pullmonkey<span class="er">$</span> cp vendor/plugins/open_flash_chart/assets/javascripts/swfobject.js public/javascripts/<tt>
</tt><span class="c"># next the open flash chart swf (GET whatever is the latest version), right now that is here: http://teethgrinder.co.uk/open-flash-chart-2/open-flash-chart.swf</span><tt>
</tt>&gt; pullmonkey<span class="er">$</span> cd public/<tt>
</tt>&gt; pullmonkey<span class="er">$</span> wget http<span class="sy">:/</span>/teethgrinder.co.uk/open-flash-chart<span class="i">-2</span>/open-flash-chart.swf<tt>
</tt>&gt; pullmonkey<span class="er">$</span> cd ..<tt>
</tt></pre>
</td>
</tr>
</table>
<h3>Edit our controller</h3>
<p>Notice here that I just include one of the many examples from the <a href="http://github.com/pullmonkey/open_flash_chart/tree/7ca9f9dbea795431aafdcc3a20dd4b73900f6fba/lib/ofc/examples">plugin's examples directory</a>.  Definitely more to follow.</p>
<p>One thing you will notice about the examples, is that the php code is in the comments, so you can see how I would convert from the php examples to ruby.  Please feel free to add your own examples, just fork the project.</p>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt><strong>5</strong><tt>
</tt>6<tt>
</tt>7<tt>
</tt>8<tt>
</tt>9<tt>
</tt><strong>10</strong><tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }"><tt>
</tt>&gt; pullmonkey<span class="er">$</span> vi app/controllers/test_it_controller.rb<tt>
</tt><span class="c"># mine looks like this:</span><tt>
</tt><span class="r">class</span> <span class="cl">TestItController</span> &lt; <span class="co">ApplicationController</span><tt>
</tt>  include <span class="co">OFC</span>::<span class="co">Examples</span>::<span class="co">AreaHollow</span><tt>
</tt><tt>
</tt>  <span class="r">def</span> <span class="fu">index</span><tt>
</tt>    <span class="iv">@graph</span> = open_flash_chart_object(<span class="i">600</span>,<span class="i">300</span>, <span class="s"><span class="dl">&quot;</span><span class="k">/test_it/area_hollow</span><span class="dl">&quot;</span></span>)<tt>
</tt>  <span class="r">end</span><tt>
</tt><span class="r">end</span><tt>
</tt></pre>
</td>
</tr>
</table>
<h3>Edit our view</h3>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt><strong>5</strong><tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }"><tt>
</tt>&gt; pullmonkey<span class="er">$</span> vi app/views/test_it/index.html.erb<tt>
</tt><span class="c"># mine looks like this:</span><tt>
</tt>&lt;%= javascript_include_tag <span class="s"><span class="dl">'</span><span class="k">swfobject</span><span class="dl">'</span></span> <span class="s"><span class="dl">%&gt;</span><span class="k"><tt>
</tt>&lt;%= @graph %</span><span class="dl">&gt;</span></span><tt>
</tt></pre>
</td>
</tr>
</table>
<h3>Start 'er up</h3>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt><strong>5</strong><tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }"><tt>
</tt>&gt; pullmonkey<span class="er">$</span> ./script/server<tt>
</tt><tt>
</tt><span class="c"># browse to the test_it index</span><tt>
</tt>http<span class="sy">:/</span>/localhost:<span class="i">3000</span>/test_it<tt>
</tt></pre>
</td>
</tr>
</table>
<h2>Our example</h2>
<div id="flash_content_blog_1"></div>
<p><script type="text/javascript">
  swfobject.embedSWF("/projects/open-flash-chart-ichor.swf", "flash_content_blog_1", "600", "300", "9.0.0", "expressInstall.swf",{"data-file":"/projects/open_flash_chart22/area_hollow"}, {"wmode":"transparent"});
</script></p>
]]></content:encoded>
					
					<wfw:commentRss>http://pullmonkey.com/2009/04/30/open-flash-chart-ii-fully-automated/feed/</wfw:commentRss>
			<slash:comments>8</slash:comments>
		
		
			</item>
		<item>
		<title>Spreadsheet Gem &#8211; data may have been lost</title>
		<link>http://pullmonkey.com/2009/04/30/spreadsheet-gem-data-may-have-been-lost/</link>
					<comments>http://pullmonkey.com/2009/04/30/spreadsheet-gem-data-may-have-been-lost/#comments</comments>
		
		<dc:creator><![CDATA[charlie]]></dc:creator>
		<pubDate>Thu, 30 Apr 2009 14:48:00 +0000</pubDate>
				<category><![CDATA[Home]]></category>
		<category><![CDATA[rails]]></category>
		<category><![CDATA[ruby]]></category>
		<category><![CDATA[error]]></category>
		<category><![CDATA[gems]]></category>
		<category><![CDATA[ruby on rails]]></category>
		<category><![CDATA[spreadsheet]]></category>
		<guid isPermaLink="false">/2009/04/30/spreadsheet-gem-data-may-have-been-lost</guid>

					<description><![CDATA[I've been using the spreadsheet gem lately for a couple projects I am working on to modify existing spreadsheets. I have quite often stumbled upon this error when opening modified spreadsheets in excel: File error: data may have been lost Like most microsoft errors, it was useless and the spreadsheet came up just fine. But [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>I've been using the <a href="http://spreadsheet.rubyforge.org/">spreadsheet gem</a> lately for a couple projects I am working on to modify existing spreadsheets.  I have quite often stumbled upon this error when opening modified spreadsheets in excel:</p>
<h2>File error: data may have been lost</h2>
<p>Like most microsoft errors, it was useless and the spreadsheet came up just fine.  But that error was just so annoying, other spreadsheet applications (open office, excel on mac) opened without any problems.  So after quite a bit of hacking and digging around, I finally tried setting the encoding, which defaults to UTF-8.  Well it just so happens that the spreadsheet being modified was encoded with UTF-16LE.  </p>
<p>So part one of my solution became this:</p>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }"><tt>
</tt><span class="co">Spreadsheet</span>.client_encoding = <span class="s"><span class="dl">'</span><span class="k">UTF-16LE</span><span class="dl">'</span></span><tt>
</tt></pre>
</td>
</tr>
</table>
<p>Then doing a little more digging I decided that this would be a better long-term solution:</p>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }"><tt>
</tt>book = <span class="co">Spreadsheet</span>.open spreadsheet_file<tt>
</tt><span class="co">Spreadsheet</span>.client_encoding = book.encoding<tt>
</tt></pre>
</td>
</tr>
</table>
<p>Well, hopefully it wasn't just me and someone will be able to save a bit of time with this.</p>
]]></content:encoded>
					
					<wfw:commentRss>http://pullmonkey.com/2009/04/30/spreadsheet-gem-data-may-have-been-lost/feed/</wfw:commentRss>
			<slash:comments>1</slash:comments>
		
		
			</item>
		<item>
		<title>Can you read this?</title>
		<link>http://pullmonkey.com/2009/04/17/can-you-read-this/</link>
		
		<dc:creator><![CDATA[charlie]]></dc:creator>
		<pubDate>Fri, 17 Apr 2009 01:41:00 +0000</pubDate>
				<category><![CDATA[Home]]></category>
		<category><![CDATA[projects]]></category>
		<category><![CDATA[rails]]></category>
		<category><![CDATA[ruby]]></category>
		<category><![CDATA[project]]></category>
		<category><![CDATA[ruby on rails]]></category>
		<guid isPermaLink="false">/2009/04/17/can-you-read-this</guid>

					<description><![CDATA[Got an email today, I have seen it before and I am sure it has been going around for years. This time, I thought that I would do an exercise and create a plugin that duplicates what I found in this email. See for yourself. Here is the email I got: What I gathered was [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>Got an email today, I have seen it before and I am sure it has been going around for years.  This time, I thought that I would do an exercise and create a plugin that duplicates what I found in this email.  See for yourself.</p>
<p>Here is the email I got:<br />
<center><img src="/assets/2009/4/17/can_you_read_this.png" /></center></p>
<p>What I gathered was that the only important letters are the first and last letter of each word, those have to be in the right order.  So the rest of the letters can be in any random order.  That is what I did - I created <a href="http://github.com/pullmonkey/can_you_read_this/tree/master">a plugin and put it out on github</a>.  You can install it like this:</p>
<pre><code>
./script/plugin install http://github.com/pullmonkey/can_you_read_this.git

</code></pre>
<p>And use it like this:</p>
<pre><code>
#in your views
<%= can_you_read_this("hello, can you read this?") %>

</code></pre>
<p>Have fun.</p>
]]></content:encoded>
					
		
		
			</item>
		<item>
		<title>Blog plugin tutorial for Ruby on Rails</title>
		<link>http://pullmonkey.com/2009/02/11/blog-plugin-tutorial-for-ruby-on-rails/</link>
					<comments>http://pullmonkey.com/2009/02/11/blog-plugin-tutorial-for-ruby-on-rails/#comments</comments>
		
		<dc:creator><![CDATA[charlie]]></dc:creator>
		<pubDate>Wed, 11 Feb 2009 20:27:00 +0000</pubDate>
				<category><![CDATA[development]]></category>
		<category><![CDATA[Home]]></category>
		<category><![CDATA[rails]]></category>
		<category><![CDATA[tutorials]]></category>
		<category><![CDATA[plugins]]></category>
		<category><![CDATA[ruby]]></category>
		<category><![CDATA[ruby on rails]]></category>
		<category><![CDATA[tutorial]]></category>
		<guid isPermaLink="false">/2009/04/02/blog-plugin-tutorial-for-ruby-on-rails</guid>

					<description><![CDATA[Update: Bloggity does not require the Engines plugin to run if you are using Rails 2.3 or above (where the Engines plugin is baked in). -- Noted below by Bill. Update: Added the plugin to github - simple_blog. It is not production ready or really all that usable quite yet. Ok, so this a rant [&#8230;]]]></description>
										<content:encoded><![CDATA[<p><b>Update:</b> Bloggity does not require the Engines plugin to run if you are using Rails 2.3 or above (where the Engines plugin is baked in). -- Noted below by Bill.<br />
<br /><b>Update:</b> Added the plugin to github - <a href="http://github.com/pullmonkey/simple_blog/tree/master">simple_blog</a>.  It is not production ready or really all that usable quite yet.</p>
<p>Ok, so this a rant and I am sorry for that - but as simple as it is, I have been looking for a blog plugin lately.  The problem with the plugins I find is that I don't want to have to deal with the engines plugin or have the controllers, models, views, etc ... all extracted into my applications code.  I want it all external (hence a plugin) but let it be minimally configurable.</p>
<p>So in my recent search for a blog plugin for rails, I came across two that look very useful, but each with their flaws:<br />
1) <a href="http://github.com/vigetlabs/bloget/tree/master">bloget</a> - Everything is extracted to my code space.  Why?  Yes, I realize that it is most likely because I will want to override things, but get out of my space and keep to yourself!  <img src="https://s.w.org/images/core/emoji/13.0.1/72x72/1f642.png" alt="🙂" class="wp-smiley" style="height: 1em; max-height: 1em;" /> <br />
Provide me a way to override things that I would need to (there really shouldn't be too many), after all it is ruby.<br />
2) <a href="http://www.williambharding.com/blog/rails/bloggity-an-evolving-rails-blog-plugin/">bloggity</a> - Uses the engines plugin! I have nothing against the engines plugin (I think it is well written and documented) but for a freaking blog plugin?!?  Why? </p>
<p>Is there a third option?<br />
Glad you asked - yes, there is a third option - I hate to say it, but do it right!  There's your third option.<br />
Ok, but really, if there is a third option (a third plugin), I would love to hear about it.</p>
<p>Ok, so all that to lead up to a little plugin tutorial?  Well, it got your attention didn't it?</p>
<h1>Starting from scratch</h1>
<p>Ok, I guess I will start from scratch.  So let's get started.</p>
<h2>Creating a plugin</h2>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt><strong>5</strong><tt>
</tt>6<tt>
</tt>7<tt>
</tt>8<tt>
</tt>9<tt>
</tt><strong>10</strong><tt>
</tt>11<tt>
</tt>12<tt>
</tt>13<tt>
</tt>14<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }">pullmonkey<span class="er">$</span> ./script/generate plugin simple_blog<tt>
</tt>      create  vendor/plugins/simple_blog/lib<tt>
</tt>      create  vendor/plugins/simple_blog/tasks<tt>
</tt>      create  vendor/plugins/simple_blog/test<tt>
</tt>      create  vendor/plugins/simple_blog/<span class="co">README</span><tt>
</tt>      create  vendor/plugins/simple_blog/<span class="co">MIT</span>-<span class="co">LICENSE</span><tt>
</tt>      create  vendor/plugins/simple_blog/<span class="co">Rakefile</span><tt>
</tt>      create  vendor/plugins/simple_blog/init.rb<tt>
</tt>      create  vendor/plugins/simple_blog/install.rb<tt>
</tt>      create  vendor/plugins/simple_blog/uninstall.rb<tt>
</tt>      create  vendor/plugins/simple_blog/lib/simple_blog.rb<tt>
</tt>      create  vendor/plugins/simple_blog/tasks/simple_blog_tasks.rake<tt>
</tt>      create  vendor/plugins/simple_blog/test/simple_blog_test.rb<tt>
</tt>      create  vendor/plugins/simple_blog/test/test_helper.rb<tt>
</tt></pre>
</td>
</tr>
</table>
<h2>Create the app directories for your plugin</h2>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt><strong>5</strong><tt>
</tt>6<tt>
</tt>7<tt>
</tt>8<tt>
</tt>9<tt>
</tt><strong>10</strong><tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }">pullmonkey<span class="er">$</span> cd vendor/plugins/simple_blog/  <span class="c"># pretty important</span><tt>
</tt>pullmonkey<span class="er">$</span> ls<tt>
</tt>init.rb  install.rb  lib  <span class="co">MIT</span>-<span class="co">LICENSE</span>  <span class="co">Rakefile</span>  <span class="co">README</span>  tasks  test  uninstall.rb<tt>
</tt>pullmonkey<span class="er">$</span> mkdir app<tt>
</tt>pullmonkey<span class="er">$</span> mkdir -p app/models<tt>
</tt>pullmonkey<span class="er">$</span> mkdir -p app/controllers<tt>
</tt>pullmonkey<span class="er">$</span> mkdir -p app/views<tt>
</tt>pullmonkey<span class="er">$</span> mkdir -p app/helpers<tt>
</tt>pullmonkey<span class="er">$</span> ls app/<tt>
</tt>controllers  helpers  models  views<tt>
</tt></pre>
</td>
</tr>
</table>
<p>Well that was easy, so let's move on.</p>
<p></p>
<h1>Models, Views, Controllers and Helpers - Living as one in my plugin</h1>
<h2>Models</h2>
<p>Ok, so we have a clear path for where our models, controllers, views, and helpers should live, right?<br />
For simplicity, let's just have a post and comment model - you have all seen this a billion times.</p>
<h3>Models: vendor/plugins/simple_blog/app/models/post.rb</h3>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }"><span class="r">class</span> <span class="cl">Post</span> &lt; <span class="co">ActiveRecord</span>::<span class="co">Base</span><tt>
</tt>  has_many <span class="sy">:comments</span><tt>
</tt><span class="r">end</span></pre>
</td>
</tr>
</table>
<h3>Models: vendor/plugins/simple_blog/app/models/comment.rb</h3>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }"><span class="r">class</span> <span class="cl">Comment</span> &lt; <span class="co">ActiveRecord</span>::<span class="co">Base</span><tt>
</tt>  belongs_to <span class="sy">:post</span><tt>
</tt><span class="r">end</span></pre>
</td>
</tr>
</table>
<p>And there you have it.<br />
So what do you do to tell your rails application about your models?<br />
Simple - inside vendor/plugins/simple_blog/init.rb - add these lines</p>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }">model_path = <span class="co">File</span>.join(directory, <span class="s"><span class="dl">'</span><span class="k">app</span><span class="dl">'</span></span>, <span class="s"><span class="dl">'</span><span class="k">models</span><span class="dl">'</span></span>)<tt>
</tt><span class="gv">$LOAD_PATH</span> &lt;&lt; model_path<tt>
</tt><span class="co">ActiveSupport</span>::<span class="co">Dependencies</span>.load_paths &lt;&lt; model_path</pre>
</td>
</tr>
</table>
<h3>Ok, so let's test it out.</h3>
<p>Step 1 - we will need some default migrations for the model to use.<br />
Post migration:</p>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt><strong>5</strong><tt>
</tt>6<tt>
</tt>7<tt>
</tt>8<tt>
</tt>9<tt>
</tt><strong>10</strong><tt>
</tt>11<tt>
</tt>12<tt>
</tt>13<tt>
</tt>14<tt>
</tt><strong>15</strong><tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }">pullmonkey<span class="er">$</span> ./script/generate migration post<tt>
</tt><span class="c"># This is what mine looks like</span><tt>
</tt><span class="r">class</span> <span class="cl">Post</span> &lt; <span class="co">ActiveRecord</span>::<span class="co">Migration</span><tt>
</tt>  <span class="r">def</span> <span class="pc">self</span>.up<tt>
</tt>    create_table <span class="sy">:posts</span> <span class="r">do</span> |t|<tt>
</tt>      t.string <span class="sy">:subject</span><tt>
</tt>      t.text   <span class="sy">:body</span><tt>
</tt>      t.timestamps<tt>
</tt>    <span class="r">end</span><tt>
</tt>  <span class="r">end</span><tt>
</tt><tt>
</tt>  <span class="r">def</span> <span class="pc">self</span>.down<tt>
</tt>    drop_table <span class="sy">:posts</span><tt>
</tt>  <span class="r">end</span><tt>
</tt><span class="r">end</span></pre>
</td>
</tr>
</table>
<p>And then the comment migration:</p>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt><strong>5</strong><tt>
</tt>6<tt>
</tt>7<tt>
</tt>8<tt>
</tt>9<tt>
</tt><strong>10</strong><tt>
</tt>11<tt>
</tt>12<tt>
</tt>13<tt>
</tt>14<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }">pullmonkey<span class="er">$</span> ./script/generate migration comment<tt>
</tt><span class="c"># This is what mine looks like</span><tt>
</tt>  <span class="r">def</span> <span class="pc">self</span>.up<tt>
</tt>    create_table <span class="sy">:comments</span> <span class="r">do</span> |t|<tt>
</tt>      t.string <span class="sy">:username</span><tt>
</tt>      t.text   <span class="sy">:body</span><tt>
</tt>      t.references <span class="sy">:post</span><tt>
</tt>      t.timestamps<tt>
</tt>    <span class="r">end</span><tt>
</tt>  <span class="r">end</span><tt>
</tt><tt>
</tt>  <span class="r">def</span> <span class="pc">self</span>.down<tt>
</tt>    drop_table <span class="sy">:comments</span><tt>
</tt>  <span class="r">end</span></pre>
</td>
</tr>
</table>
<p>Run the migrations:</p>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre><tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }">pullmonkey<span class="er">$</span> rake db<span class="sy">:migrate</span></pre>
</td>
</tr>
</table>
<p>That was all just setup - now for the actual testing:</p>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt><strong>5</strong><tt>
</tt>6<tt>
</tt>7<tt>
</tt>8<tt>
</tt>9<tt>
</tt><strong>10</strong><tt>
</tt>11<tt>
</tt>12<tt>
</tt>13<tt>
</tt>14<tt>
</tt><strong>15</strong><tt>
</tt>16<tt>
</tt>17<tt>
</tt>18<tt>
</tt>19<tt>
</tt><strong>20</strong><tt>
</tt>21<tt>
</tt>22<tt>
</tt>23<tt>
</tt>24<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }">pullmonkey<span class="er">$</span> ./script/console<tt>
</tt><span class="co">Loading</span> development environment (<span class="co">Rails</span> <span class="fl">2.2</span>.<span class="i">2</span>)<tt>
</tt>&gt;&gt; <span class="co">Comment</span>.new<tt>
</tt>=&gt; <span class="c">#&lt;Comment id: nil, username: nil, body: nil, post_id: nil, created_at: nil, updated_at: nil&gt;</span><tt>
</tt>&gt;&gt; <span class="co">Post</span>.new<tt>
</tt>=&gt; <span class="c">#&lt;Post id: nil, subject: nil, body: nil, created_at: nil, updated_at: nil&gt;</span><tt>
</tt>&gt;&gt; p = <span class="co">Post</span>.create(<span class="sy">:subject</span> =&gt; <span class="s"><span class="dl">&quot;</span><span class="k">Test 1</span><span class="dl">&quot;</span></span>, <span class="sy">:body</span> =&gt; <span class="s"><span class="dl">&quot;</span><span class="k">My Body</span><span class="dl">&quot;</span></span>)<tt>
</tt>=&gt; <span class="c">#&lt;Post id: 1, subject: &quot;Test 1&quot;, body: &quot;My Body&quot;, created_at: &quot;2009-02-11 19:09:25&quot;, updated_at: &quot;2009-02-11 19:09:25&quot;&gt;</span><tt>
</tt>&gt;&gt; p.body<tt>
</tt>=&gt; <span class="s"><span class="dl">&quot;</span><span class="k">My Body</span><span class="dl">&quot;</span></span><tt>
</tt>&gt;&gt; p.subject<tt>
</tt>=&gt; <span class="s"><span class="dl">&quot;</span><span class="k">Test 1</span><span class="dl">&quot;</span></span><tt>
</tt>&gt;&gt; p.new_record?<tt>
</tt>=&gt; <span class="pc">false</span><tt>
</tt>&gt;&gt; p.comments<tt>
</tt>=&gt; []<tt>
</tt>&gt;&gt; c = <span class="co">Comment</span>.create(<span class="sy">:username</span> =&gt; <span class="s"><span class="dl">'</span><span class="k">pullmonkey</span><span class="dl">'</span></span>, <span class="sy">:body</span> =&gt; <span class="s"><span class="dl">&quot;</span><span class="k">this is simple</span><span class="dl">&quot;</span></span>)<tt>
</tt>=&gt; <span class="c">#&lt;Comment id: 1, username: &quot;pullmonkey&quot;, body: &quot;this is simple&quot;, post_id: nil, created_at: &quot;2009-02-11 19:10:01&quot;, updated_at: &quot;2009-02-11 19:10:01&quot;&gt;</span><tt>
</tt>&gt;&gt; p.comments &lt;&lt; c<tt>
</tt>=&gt; [<span class="c">#&lt;Comment id: 1, username: &quot;pullmonkey&quot;, body: &quot;this is simple&quot;, post_id: 1, created_at: &quot;2009-02-11 19:10:01&quot;, updated_at: &quot;2009-02-11 19:10:06&quot;&gt;]</span><tt>
</tt>&gt;&gt; p.comments<tt>
</tt>=&gt; [<span class="c">#&lt;Comment id: 1, username: &quot;pullmonkey&quot;, body: &quot;this is simple&quot;, post_id: 1, created_at: &quot;2009-02-11 19:10:01&quot;, updated_at: &quot;2009-02-11 19:10:06&quot;&gt;]</span><tt>
</tt>&gt;&gt; <span class="co">Post</span>.first.comments<tt>
</tt>=&gt; [<span class="c">#&lt;Comment id: 1, username: &quot;pullmonkey&quot;, body: &quot;this is simple&quot;, post_id: 1, created_at: &quot;2009-02-11 19:10:01&quot;, updated_at: &quot;2009-02-11 19:10:06&quot;&gt;]</span></pre>
</td>
</tr>
</table>
<p>That's probably good enough.  We have a working model and relationships.  The best part is that all the code is still in the plugin.<br />
What does my code space contain?</p>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt><strong>5</strong><tt>
</tt>6<tt>
</tt>7<tt>
</tt>8<tt>
</tt>9<tt>
</tt><strong>10</strong><tt>
</tt>11<tt>
</tt>12<tt>
</tt>13<tt>
</tt>14<tt>
</tt><strong>15</strong><tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }">pullmonkey<span class="er">$</span> ls -l app/**<tt>
</tt>app/controllers:<tt>
</tt>total <span class="i">4</span><tt>
</tt>-rw-rw-r--  <span class="i">1</span> pullmonkey pullmonkey <span class="i">720</span> <span class="co">Feb</span> <span class="i">11</span> <span class="i">11</span>:<span class="i">00</span> application.rb<tt>
</tt><tt>
</tt>app/helpers:<tt>
</tt>total <span class="i">4</span><tt>
</tt>-rw-rw-r--  <span class="i">1</span> pullmonkey pullmonkey <span class="i">115</span> <span class="co">Feb</span> <span class="i">11</span> <span class="i">11</span>:<span class="i">00</span> application_helper.rb<tt>
</tt><tt>
</tt>app/models:<tt>
</tt>total <span class="i">0</span><tt>
</tt><tt>
</tt>app/views:<tt>
</tt>total <span class="i">4</span><tt>
</tt>drwxrwxr-x  <span class="i">2</span> pullmonkey pullmonkey <span class="i">4096</span> <span class="co">Feb</span> <span class="i">11</span> <span class="i">11</span>:<span class="i">00</span> layouts</pre>
</td>
</tr>
</table>
<p>
Just the defaults - neat <img src="https://s.w.org/images/core/emoji/13.0.1/72x72/1f642.png" alt="🙂" class="wp-smiley" style="height: 1em; max-height: 1em;" /></p>
<h2>Controllers</h2>
<p>In much the same way as models, we can easily use controllers from our plugin.  No extracting, no engines plugin.</p>
<h3>Controllers: vendor/plugins/simple_blog/app/controllers/posts_controller.rb</h3>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt><strong>5</strong><tt>
</tt>6<tt>
</tt>7<tt>
</tt>8<tt>
</tt>9<tt>
</tt><strong>10</strong><tt>
</tt>11<tt>
</tt>12<tt>
</tt>13<tt>
</tt>14<tt>
</tt><strong>15</strong><tt>
</tt>16<tt>
</tt>17<tt>
</tt>18<tt>
</tt>19<tt>
</tt><strong>20</strong><tt>
</tt>21<tt>
</tt>22<tt>
</tt>23<tt>
</tt>24<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }"><span class="r">class</span> <span class="cl">PostsController</span> &lt; <span class="co">ApplicationController</span><tt>
</tt>  <span class="r">def</span> <span class="fu">index</span><tt>
</tt>    <span class="iv">@posts</span> = <span class="co">Post</span>.all<tt>
</tt>  <span class="r">end</span><tt>
</tt><tt>
</tt>  <span class="r">def</span> <span class="fu">show</span><tt>
</tt>    <span class="iv">@post</span> = <span class="co">Post</span>.find(params[<span class="sy">:id</span>])<tt>
</tt>  <span class="r">end</span><tt>
</tt><tt>
</tt>  <span class="r">def</span> <span class="fu">new</span><tt>
</tt>    <span class="iv">@post</span> = <span class="co">Post</span>.new<tt>
</tt>  <span class="r">end</span><tt>
</tt><tt>
</tt>  <span class="r">def</span> <span class="fu">create</span><tt>
</tt>    <span class="r">if</span> <span class="iv">@post</span> = <span class="co">Post</span>.create(params[<span class="sy">:post</span>])<tt>
</tt>      flash[<span class="sy">:notice</span>] = <span class="s"><span class="dl">&quot;</span><span class="k">Post Created</span><span class="dl">&quot;</span></span><tt>
</tt>      redirect_to <span class="sy">:action</span> =&gt; <span class="s"><span class="dl">'</span><span class="k">index</span><span class="dl">'</span></span><tt>
</tt>    <span class="r">else</span><tt>
</tt>      flash[<span class="sy">:error</span>] = <span class="s"><span class="dl">&quot;</span><span class="k">Post Not Created</span><span class="dl">&quot;</span></span><tt>
</tt>      render <span class="sy">:action</span> =&gt; <span class="s"><span class="dl">'</span><span class="k">new</span><span class="dl">'</span></span><tt>
</tt>    <span class="r">end</span><tt>
</tt>  <span class="r">end</span><tt>
</tt>  <span class="c">#.... more code</span><tt>
</tt><span class="r">end</span></pre>
</td>
</tr>
</table>
<h3>Controllers: vendor/plugins/simple_blog/app/controllers/comments_controller.rb</h3>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt><strong>5</strong><tt>
</tt>6<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }"><span class="r">class</span> <span class="cl">CommentsController</span> &lt; <span class="co">ApplicationController</span><tt>
</tt>  <span class="r">def</span> <span class="fu">index</span><tt>
</tt>    <span class="iv">@comments</span> = <span class="co">Comment</span>.find_all_by_post_id(params[<span class="sy">:post_id</span>])<tt>
</tt>  <span class="r">end</span><tt>
</tt>  <span class="c">#.... more code</span><tt>
</tt><span class="r">end</span></pre>
</td>
</tr>
</table>
<p>Now, to register the controllers, add the following to vendor/plugins/simple_blog/init.rb:</p>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }">controller_path = <span class="co">File</span>.join(directory, <span class="s"><span class="dl">'</span><span class="k">app</span><span class="dl">'</span></span>, <span class="s"><span class="dl">'</span><span class="k">controllers</span><span class="dl">'</span></span>)<tt>
</tt><span class="gv">$LOAD_PATH</span> &lt;&lt; controller_path<tt>
</tt><span class="co">ActiveSupport</span>::<span class="co">Dependencies</span>.load_paths &lt;&lt; controller_path<tt>
</tt>config.controller_paths &lt;&lt; controller_path</pre>
</td>
</tr>
</table>
<p>Ok, before we can really test this we will need to do the views, so keep going.</p>
<p></p>
<h2>Views</h2>
<p>Create your view directories:</p>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }">pullmonkey<span class="er">$</span> mkdir -p app/views/posts<tt>
</tt>pullmonkey<span class="er">$</span> mkdir -p app/views/comments</pre>
</td>
</tr>
</table>
<p>Create your views:<br />
For this example, I will just create one, then we will test it.</p>
<h3>Views: vendor/plugins/simple_blog/app/views/posts/index.html.erb</h3>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt><strong>5</strong><tt>
</tt>6<tt>
</tt>7<tt>
</tt>8<tt>
</tt>9<tt>
</tt><strong>10</strong><tt>
</tt>11<tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }">&lt;h1&gt;<span class="co">Posts</span>&lt;<span class="rx"><span class="dl">/</span><span class="k">h1&gt;<tt>
</tt>&lt;% @posts.each do |post| -%&gt;<tt>
</tt>  &lt;h2&gt;&lt;%= h post.subject %&gt;&lt;</span><span class="dl">/</span></span>h2&gt;<tt>
</tt>  &lt;%= post.body <span class="s"><span class="dl">%&gt;</span><span class="k"><tt>
</tt>  &lt;h3</span><span class="dl">&gt;</span></span><span class="co">Comments</span>&lt;<span class="rx"><span class="dl">/</span><span class="k">h3&gt;<tt>
</tt>  &lt;% post.comments.each do |comment| -%&gt;<tt>
</tt>    &lt;b&gt;by &lt;%= comment.username %&gt;&lt;</span><span class="dl">/</span></span>b&gt;&lt;br/&gt;<tt>
</tt>    &lt;%= comment.body <span class="s"><span class="dl">%&gt;</span><span class="k">&lt;br/</span><span class="dl">&gt;</span></span><tt>
</tt>    &lt;br/&gt;<tt>
</tt>  &lt;% <span class="r">end</span> -<span class="s"><span class="dl">%&gt;</span><span class="k"><tt>
</tt>&lt;% end -%</span><span class="dl">&gt;</span></span></pre>
</td>
</tr>
</table>
<h3>Append your view paths:</h3>
<p>If you don't do this next step, you will very likely see an error message like this:<br />
Missing template posts/index.erb in view path /home/pullmonkey/rails_projects/simple_blog/app/views:</p>
<p>So let's add it. <br />
There are at least two ways to do this.  1) Added to your controllers individually or 2) Add to application controller globally.<br />
I prefer the less obtrusive, so let's go with number 1.<br />
For this test, we will just work with the posts controller, so open it up again and add this line:</p>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre><tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }"><span class="pc">self</span>.append_view_path(<span class="co">File</span>.join(<span class="co">File</span>.dirname(<span class="pc">__FILE__</span>), <span class="s"><span class="dl">'</span><span class="k">..</span><span class="dl">'</span></span>, <span class="s"><span class="dl">'</span><span class="k">views</span><span class="dl">'</span></span>))</pre>
</td>
</tr>
</table>
<p>So your file should look like this now:</p>
<table class="CodeRay">
<tr>
<td class="line_numbers" title="click to toggle" onclick="with (this.firstChild.style) { display = (display == '') ? 'none' : '' }">
<pre>1<tt>
</tt>2<tt>
</tt>3<tt>
</tt>4<tt>
</tt><strong>5</strong><tt>
</tt>6<tt>
</tt>7<tt>
</tt>8<tt>
</tt>9<tt>
</tt><strong>10</strong><tt>
</tt>11<tt>
</tt>12<tt>
</tt>13<tt>
</tt>14<tt>
</tt><strong>15</strong><tt>
</tt>16<tt>
</tt>17<tt>
</tt>18<tt>
</tt>19<tt>
</tt><strong>20</strong><tt>
</tt>21<tt>
</tt>22<tt>
</tt>23<tt>
</tt>24<tt>
</tt><strong>25</strong><tt>
</tt></pre>
</td>
<td class="code">
<pre ondblclick="with (this.style) { overflow = (overflow == 'auto' || overflow == '') ? 'visible' : 'auto' }"><span class="r">class</span> <span class="cl">PostsController</span> &lt; <span class="co">ApplicationController</span><tt>
</tt>  <span class="pc">self</span>.append_view_path(<span class="co">File</span>.join(<span class="co">File</span>.dirname(<span class="pc">__FILE__</span>), <span class="s"><span class="dl">'</span><span class="k">..</span><span class="dl">'</span></span>, <span class="s"><span class="dl">'</span><span class="k">views</span><span class="dl">'</span></span>))<tt>
</tt><tt>
</tt>  <span class="r">def</span> <span class="fu">index</span><tt>
</tt>    <span class="iv">@posts</span> = <span class="co">Post</span>.all<tt>
</tt>  <span class="r">end</span><tt>
</tt><tt>
</tt>  <span class="r">def</span> <span class="fu">show</span><tt>
</tt>    <span class="iv">@post</span> = <span class="co">Post</span>.find(params[<span class="sy">:id</span>])<tt>
</tt>  <span class="r">end</span><tt>
</tt><tt>
</tt>  <span class="r">def</span> <span class="fu">new</span><tt>
</tt>    <span class="iv">@post</span> = <span class="co">Post</span>.new<tt>
</tt>  <span class="r">end</span><tt>
</tt><tt>
</tt>  <span class="r">def</span> <span class="fu">create</span><tt>
</tt>    <span class="r">if</span> <span class="iv">@post</span> = <span class="co">Post</span>.create(params[<span class="sy">:post</span>])<tt>
</tt>      flash[<span class="sy">:notice</span>] = <span class="s"><span class="dl">&quot;</span><span class="k">Post Created</span><span class="dl">&quot;</span></span><tt>
</tt>      redirect_to <span class="sy">:action</span> =&gt; <span class="s"><span class="dl">'</span><span class="k">index</span><span class="dl">'</span></span><tt>
</tt>    <span class="r">else</span><tt>
</tt>      flash[<span class="sy">:error</span>] = <span class="s"><span class="dl">&quot;</span><span class="k">Post Not Created</span><span class="dl">&quot;</span></span><tt>
</tt>      render <span class="sy">:action</span> =&gt; <span class="s"><span class="dl">'</span><span class="k">new</span><span class="dl">'</span></span><tt>
</tt>    <span class="r">end</span><tt>
</tt>  <span class="r">end</span><tt>
</tt><span class="r">end</span></pre>
</td>
</tr>
</table>
<h3>Time to test</h3>
<p>Start your web server - ./script/server<br />
Browse to http://localhost:3000/posts<br />
You should see the post we created up above via Post.create(...) and its associated comment that we also created above.</p>
<p><b>Note:</b>Feel free to overwrite any of the views.  This can be done simply for the posts index view by creating the same file under RAILS_ROOT/app/views/posts/index.html.erb and doing what you'd like.</p>
<p></p>
<h1>That's it for part 1</h1>
<p>Ok, so that's part 1.  The goal was to keep everything external and I think we succeeded (aside from migrations).<br />
No offense to those that use engines or extract files into one's application's space, we all have our ways - the above is what I prefer.</p>
<p>
Part 2 will consist mainly of filling this out a bit more and further discussion on adding helpers, routes and migrations to your plugin without interfering in the application's code space.</p>
<p>As always, have fun and good luck!</p>
]]></content:encoded>
					
					<wfw:commentRss>http://pullmonkey.com/2009/02/11/blog-plugin-tutorial-for-ruby-on-rails/feed/</wfw:commentRss>
			<slash:comments>11</slash:comments>
		
		
			</item>
	</channel>
</rss>
